

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pynetdicom.ae &mdash; pynetdicom 1.2.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/pynetdicom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/pynetdicom.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> pynetdicom
          

          
            
            <img src="../../_static/pydicom_flat_black.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../verification_service_class.html">Verification Service Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../storage_service_class.html">Storage Service Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../query_retrieve_service_class.html">Query/Retrieve Service Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../basic_worklist_service_class.html">Basic Worklist Management Service Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../relevant_patient_service_class.html">Relevant Patient Information Query Service Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../substance_admin_service_class.html">Substance Administration Query Service Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../non_patient_service_class.html">Non-Patient Object Storage Service Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../color_palette_service_class.html">Color Palette Query/Retrieve Service Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../defined_procedure_service_class.html">Defined Procedure Protocol Query/Retrieve Service Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hanging_protocol_service_class.html">Hanging Protocol Query/Retrieve Service Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../implant_template_service_class.html">Implant Template Query/Retrieve Service Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../display_system_service_class.html">Display System Management Service Class</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../user/index.html">User Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes.html">1.2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes.html#v1-1-0">1.1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes.html#v1-0-0">1.0.0</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pynetdicom</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>pynetdicom.ae</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pynetdicom.ae</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">The main user class, represents a DICOM Application Entity</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="k">import</span> <span class="n">deepcopy</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">datetime</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">select</span>
<span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">from</span> <span class="nn">struct</span> <span class="k">import</span> <span class="n">pack</span>
<span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">from</span> <span class="nn">pydicom.uid</span> <span class="k">import</span> <span class="n">UID</span>

<span class="kn">from</span> <span class="nn">pynetdicom.association</span> <span class="k">import</span> <span class="n">Association</span>
<span class="kn">from</span> <span class="nn">pynetdicom.presentation</span> <span class="k">import</span> <span class="n">PresentationContext</span>
<span class="kn">from</span> <span class="nn">pynetdicom.transport</span> <span class="k">import</span> <span class="p">(</span>
    <span class="n">AssociationSocket</span><span class="p">,</span> <span class="n">AssociationServer</span><span class="p">,</span> <span class="n">ThreadedAssociationServer</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">pynetdicom.utils</span> <span class="k">import</span> <span class="n">validate_ae_title</span>
<span class="kn">from</span> <span class="nn">pynetdicom._globals</span> <span class="k">import</span> <span class="p">(</span>
    <span class="n">MODE_REQUESTOR</span><span class="p">,</span>
    <span class="n">MODE_ACCEPTOR</span><span class="p">,</span>
    <span class="n">DEFAULT_MAX_LENGTH</span><span class="p">,</span>
    <span class="n">DEFAULT_TRANSFER_SYNTAXES</span>
<span class="p">)</span>


<span class="k">def</span> <span class="nf">setup_logger</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Setup the logger.&quot;&quot;&quot;</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;pynetdicom&#39;</span><span class="p">)</span>
    <span class="n">handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>
    <span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%(levelname).1s</span><span class="s1">: </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">logger</span>


<span class="n">LOGGER</span> <span class="o">=</span> <span class="n">setup_logger</span><span class="p">()</span>


<div class="viewcode-block" id="ApplicationEntity"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity">[docs]</a><span class="k">class</span> <span class="nc">ApplicationEntity</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represents a DICOM Application Entity (AE).</span>

<span class="sd">    An AE may be a *Service Class Provider* (SCP), a *Service Class User* (SCU)</span>
<span class="sd">    or both.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    acse_timeout : int or float or None</span>
<span class="sd">        The maximum amount of time (in seconds) to wait for association related</span>
<span class="sd">        messages. A value of ``None`` means no timeout. (default: 30)</span>
<span class="sd">    address : str</span>
<span class="sd">        The local AE&#39;s TCP/IP address. Deprecated and will be removed in v1.3.</span>
<span class="sd">    ae_title : bytes</span>
<span class="sd">        The local AE&#39;s AE title.</span>
<span class="sd">    bind_addr : str</span>
<span class="sd">        The network interface to listen to (default: all available network</span>
<span class="sd">        interfaces on the machine). This parameter is deprecated and will be</span>
<span class="sd">        removed in v1.3. Use the ``address`` parameter for ``start_server()``</span>
<span class="sd">        and the ``bind_address`` keyword parameter for ``associate()`` instead.</span>
<span class="sd">    dimse_timeout : int or float or None</span>
<span class="sd">        The maximum amount of time (in seconds) to wait for DIMSE related</span>
<span class="sd">        messages. A value of ``None`` means no timeout. (default: 30)</span>
<span class="sd">    local_socket : socket.socket</span>
<span class="sd">        The socket used for connections with peer AEs when acting as the</span>
<span class="sd">        association acceptor. Deprecated and will be removed in v1.3.</span>
<span class="sd">    network_timeout : int or float or None</span>
<span class="sd">        The maximum amount of time (in seconds) to wait for network messages.</span>
<span class="sd">        A value of ``None`` means no timeout. (default: 60)</span>
<span class="sd">    maximum_associations : int</span>
<span class="sd">        The maximum number of simultaneous associations requested by remote</span>
<span class="sd">        AEs. Note that this does not include the number of associations</span>
<span class="sd">        requested by the local AE (default 10).</span>
<span class="sd">    maximum_pdu_size : int</span>
<span class="sd">        The maximum PDU receive size in bytes. A value of 0 means there is no</span>
<span class="sd">        maximum size (default: 16382)</span>
<span class="sd">    port : int</span>
<span class="sd">        The local AE&#39;s listen port number when acting as an SCP or connection</span>
<span class="sd">        port when acting as an SCU. A value of 0 indicates that the operating</span>
<span class="sd">        system should choose the port. This parameter is deprecated and will</span>
<span class="sd">        be removed in v1.3. Use the ``address`` parameter for</span>
<span class="sd">        ``start_server()`` and the ``bind_address`` keyword parameter for</span>
<span class="sd">        ``associate()`` instead.</span>
<span class="sd">    require_calling_aet : list of bytes</span>
<span class="sd">        If not an empty list, the association request&#39;s *Calling AE Title*</span>
<span class="sd">        value must match one of the values in `require_calling_aet`. If an</span>
<span class="sd">        empty list then no matching will be performed (default). (Association</span>
<span class="sd">        acceptor only).</span>
<span class="sd">    require_called_aet : bool</span>
<span class="sd">        If True, the association request&#39;s *Called AE Title* value</span>
<span class="sd">        must match AE.ae_title (default False). (Association acceptor only).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pylint: disable=too-many-instance-attributes,too-many-public-methods</span>
<div class="viewcode-block" id="ApplicationEntity.__init__"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ae_title</span><span class="o">=</span><span class="sa">b</span><span class="s1">&#39;PYNETDICOM&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new Application Entity.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ae_title : bytes, optional</span>
<span class="sd">            The AE title of the Application Entity (default: ``b&#39;PYNETDICOM&#39;``)</span>
<span class="sd">        port : int, optional</span>
<span class="sd">            The port number to listen for association requests when acting as</span>
<span class="sd">            an SCP and to use when requesting an association as an SCU. When</span>
<span class="sd">            set to 0 the OS will use the first available port (default ``0``).</span>
<span class="sd">            This parameter is deprecated and will be removed in v1.3. Use</span>
<span class="sd">            the ``address`` parameter for ``start_server()`` and the</span>
<span class="sd">            ``bind_address`` keyword parameter for ``associate()`` instead.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ae_title</span> <span class="o">=</span> <span class="n">ae_title</span>

        <span class="kn">from</span> <span class="nn">pynetdicom</span> <span class="k">import</span> <span class="p">(</span>
            <span class="n">PYNETDICOM_IMPLEMENTATION_UID</span><span class="p">,</span>
            <span class="n">PYNETDICOM_IMPLEMENTATION_VERSION</span>
        <span class="p">)</span>

        <span class="c1"># Default Implementation Class UID and Version Name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">implementation_class_uid</span> <span class="o">=</span> <span class="n">PYNETDICOM_IMPLEMENTATION_UID</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">implementation_version_name</span> <span class="o">=</span> <span class="n">PYNETDICOM_IMPLEMENTATION_VERSION</span>

        <span class="c1"># TODO: remove in v1.3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">gethostbyname</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">gethostname</span><span class="p">())</span>
        <span class="c1"># TODO: remove in v1.3</span>
        <span class="k">if</span> <span class="n">port</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;The `port` keyword parameter for AE() is deprecated and will &quot;</span>
                <span class="s2">&quot;be removed in v1.3. Use the `address` parameter for &quot;</span>
                <span class="s2">&quot;AE.start_server() or the `bind_address` keyword parameter &quot;</span>
                <span class="s2">&quot;for AE.associate() instead&quot;</span><span class="p">,</span>
                <span class="ne">DeprecationWarning</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">port</span>
        <span class="c1"># TODO: remove in v1.3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bind_addr</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="c1"># List of PresentationContext</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_requested_contexts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># {abstract_syntax : PresentationContext}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_supported_contexts</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># Default maximum simultaneous associations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maximum_associations</span> <span class="o">=</span> <span class="mi">10</span>

        <span class="c1"># Default maximum PDU receive size (in bytes)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maximum_pdu_size</span> <span class="o">=</span> <span class="n">DEFAULT_MAX_LENGTH</span>

        <span class="c1"># Default timeouts - None means no timeout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">acse_timeout</span> <span class="o">=</span> <span class="mi">30</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dimse_timeout</span> <span class="o">=</span> <span class="mi">30</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">network_timeout</span> <span class="o">=</span> <span class="mi">60</span>

        <span class="c1"># Require Calling/Called AE titles to match if value is non-empty str</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">require_calling_aet</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">require_called_aet</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># TODO: remove in v1.3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">local_socket</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_servers</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Used to terminate AE when running as an SCP</span>
        <span class="c1"># TODO: remove in v1.3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_quit</span> <span class="o">=</span> <span class="kc">False</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">acse_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the ACSE timeout value.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_acse_timeout</span>

    <span class="nd">@acse_timeout</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">acse_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the ACSE timeout (in seconds).&quot;&quot;&quot;</span>
        <span class="c1"># pylint: disable=attribute-defined-outside-init</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_acse_timeout</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_acse_timeout</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;ACSE timeout set to 30 seconds&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_acse_timeout</span> <span class="o">=</span> <span class="mi">30</span>

        <span class="k">for</span> <span class="n">assoc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_associations</span><span class="p">:</span>
            <span class="n">assoc</span><span class="o">.</span><span class="n">acse_timeout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">acse_timeout</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">active_associations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a list of the AE&#39;s active Associations threads.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list of threading.Thread</span>
<span class="sd">            A list of all active association threads, both requestors and</span>
<span class="sd">            acceptors.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">threads</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">enumerate</span><span class="p">()</span>
        <span class="n">t_assocs</span> <span class="o">=</span> <span class="p">[</span><span class="n">tt</span> <span class="k">for</span> <span class="n">tt</span> <span class="ow">in</span> <span class="n">threads</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="n">Association</span><span class="p">)]</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">tt</span> <span class="k">for</span> <span class="n">tt</span> <span class="ow">in</span> <span class="n">t_assocs</span> <span class="k">if</span> <span class="n">tt</span><span class="o">.</span><span class="n">ae</span> <span class="o">==</span> <span class="bp">self</span><span class="p">]</span>

<div class="viewcode-block" id="ApplicationEntity.add_requested_context"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity.add_requested_context">[docs]</a>    <span class="k">def</span> <span class="nf">add_requested_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abstract_syntax</span><span class="p">,</span> <span class="n">transfer_syntax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a Presentation Context to be proposed when sending Association</span>
<span class="sd">        requests.</span>

<span class="sd">        When an SCU sends an Association request to a peer it includes a list</span>
<span class="sd">        of presentation contexts it would like the peer to support [1]_. This</span>
<span class="sd">        method adds a single</span>
<span class="sd">        :py:class:`PresentationContext</span>
<span class="sd">        &lt;pynetdicom.presentation.PresentationContext&gt;`</span>
<span class="sd">        to the list of the SCU&#39;s requested contexts.</span>

<span class="sd">        Only 128 presentation contexts can be included in the association</span>
<span class="sd">        request [2]_. Multiple presentation contexts may be requested with the</span>
<span class="sd">        same abstract syntax.</span>

<span class="sd">        To remove a requested context or one or more of its transfer syntaxes</span>
<span class="sd">        see the ``remove_requested_context`` method.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        abstract_syntax : str or pydicom.uid.UID</span>
<span class="sd">            The abstract syntax of the presentation context to request.</span>
<span class="sd">        transfer_syntax :  str/pydicom.uid.UID or list of str/pydicom.uid.UID</span>
<span class="sd">            The transfer syntax(es) to request (default: Implicit VR Little</span>
<span class="sd">            Endian, Explicit VR Little Endian, Explicit VR Big Endian).</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If 128 requested presentation contexts have already been added.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Add a requested presentation context for *Verification SOP Class* with</span>
<span class="sd">        the default transfer syntaxes by using its UID value.</span>

<span class="sd">        &gt;&gt;&gt; from pynetdicom import AE</span>
<span class="sd">        &gt;&gt;&gt; ae = AE()</span>
<span class="sd">        &gt;&gt;&gt; ae.add_requested_context(&#39;1.2.840.10008.1.1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; print(ae.requested_contexts[0])</span>
<span class="sd">        Abstract Syntax: Verification SOP Class</span>
<span class="sd">        Transfer Syntax(es):</span>
<span class="sd">            =Implicit VR Little Endian</span>
<span class="sd">            =Explicit VR Little Endian</span>
<span class="sd">            =Explicit VR Big Endian</span>

<span class="sd">        Add a requested presentation context for *Verification SOP Class* with</span>
<span class="sd">        the default transfer syntaxes by using the inbuilt</span>
<span class="sd">        `VerificationSOPClass` object.</span>

<span class="sd">        &gt;&gt;&gt; from pynetdicom import AE</span>
<span class="sd">        &gt;&gt;&gt; from pynetdicom.sop_class import VerificationSOPClass</span>
<span class="sd">        &gt;&gt;&gt; ae = AE()</span>
<span class="sd">        &gt;&gt;&gt; ae.add_requested_context(VerificationSOPClass)</span>

<span class="sd">        Add a requested presentation context for *Verification SOP Class* with</span>
<span class="sd">        a transfer syntax of *Implicit VR Little Endian*.</span>

<span class="sd">        &gt;&gt;&gt; from pydicom.uid import ImplicitVRLittleEndian</span>
<span class="sd">        &gt;&gt;&gt; from pynetdicom import AE</span>
<span class="sd">        &gt;&gt;&gt; from pynetdicom.sop_class import VerificationSOPClass</span>
<span class="sd">        &gt;&gt;&gt; ae = AE()</span>
<span class="sd">        &gt;&gt;&gt; ae.add_requested_context(VerificationSOPClass,</span>
<span class="sd">        ...                          ImplicitVRLittleEndian)</span>
<span class="sd">        &gt;&gt;&gt; print(ae.requested_contexts[0])</span>
<span class="sd">        Abstract Syntax: Verification SOP Class</span>
<span class="sd">        Transfer Syntax(es):</span>
<span class="sd">            =Implicit VR Little Endian</span>

<span class="sd">        Add two requested presentation contexts for *Verification SOP Class*</span>
<span class="sd">        using different transfer syntaxes for each.</span>

<span class="sd">        &gt;&gt;&gt; from pydicom.uid import (</span>
<span class="sd">        ...     ImplicitVRLittleEndian, ExplicitVRLittleEndian,</span>
<span class="sd">        ...     ExplicitVRBigEndian</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; from pynetdicom import AE</span>
<span class="sd">        &gt;&gt;&gt; from pynetdicom.sop_class import VerificationSOPClass</span>
<span class="sd">        &gt;&gt;&gt; ae = AE()</span>
<span class="sd">        &gt;&gt;&gt; ae.add_requested_context(VerificationSOPClass,</span>
<span class="sd">        ...                          [ImplicitVRLittleEndian,</span>
<span class="sd">        ...                           ExplicitVRBigEndian])</span>
<span class="sd">        &gt;&gt;&gt; ae.add_requested_context(VerificationSOPClass,</span>
<span class="sd">        ...                          ExplicitVRLittleEndian)</span>
<span class="sd">        &gt;&gt;&gt; len(ae.requested_contexts)</span>
<span class="sd">        2</span>
<span class="sd">        &gt;&gt;&gt; print(ae.requested_contexts[0])</span>
<span class="sd">        Abstract Syntax: Verification SOP Class</span>
<span class="sd">        Transfer Syntax(es):</span>
<span class="sd">            =Implicit VR Little Endian</span>
<span class="sd">            =Explicit VR Big Endian</span>
<span class="sd">        &gt;&gt;&gt; print(ae.requested_contexts[1])</span>
<span class="sd">        Abstract Syntax: Verification SOP Class</span>
<span class="sd">        Transfer Syntax(es):</span>
<span class="sd">            =Explicit VR Little Endian</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        .. [1] DICOM Standard, Part 8, `Section 7.1.1.13 &lt;http://dicom.nema.org/medical/dicom/current/output/html/part08.html#sect_7.1.1.13&gt;`_</span>
<span class="sd">        .. [2] DICOM Standard, Part 8, `Table 9-18 &lt;http://dicom.nema.org/medical/dicom/current/output/html/part08.html#table_9-18&gt;`_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">transfer_syntax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">transfer_syntax</span> <span class="o">=</span> <span class="n">DEFAULT_TRANSFER_SYNTAXES</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">requested_contexts</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">128</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Failed to add the requested presentation context as there &quot;</span>
                <span class="s2">&quot;are already the maximum allowed number of requested contexts&quot;</span>
            <span class="p">)</span>

        <span class="n">abstract_syntax</span> <span class="o">=</span> <span class="n">UID</span><span class="p">(</span><span class="n">abstract_syntax</span><span class="p">)</span>

        <span class="c1"># Allow single transfer syntax values for convenience</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">transfer_syntax</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">transfer_syntax</span> <span class="o">=</span> <span class="p">[</span><span class="n">transfer_syntax</span><span class="p">]</span>

        <span class="n">context</span> <span class="o">=</span> <span class="n">PresentationContext</span><span class="p">()</span>
        <span class="n">context</span><span class="o">.</span><span class="n">abstract_syntax</span> <span class="o">=</span> <span class="n">abstract_syntax</span>
        <span class="n">context</span><span class="o">.</span><span class="n">transfer_syntax</span> <span class="o">=</span> <span class="p">[</span><span class="n">UID</span><span class="p">(</span><span class="n">syntax</span><span class="p">)</span> <span class="k">for</span> <span class="n">syntax</span> <span class="ow">in</span> <span class="n">transfer_syntax</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_requested_contexts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">context</span><span class="p">)</span></div>

<div class="viewcode-block" id="ApplicationEntity.add_supported_context"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity.add_supported_context">[docs]</a>    <span class="k">def</span> <span class="nf">add_supported_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abstract_syntax</span><span class="p">,</span> <span class="n">transfer_syntax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">scu_role</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scp_role</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a supported presentation context.</span>

<span class="sd">        When an Association request is received from a peer it supplies a list</span>
<span class="sd">        of presentation contexts that it would like the SCP to support. This</span>
<span class="sd">        method adds a `PresentationContext` to the list of the SCP&#39;s</span>
<span class="sd">        supported contexts.</span>

<span class="sd">        Where the abstract syntax is already supported the transfer syntaxes</span>
<span class="sd">        will be extended by the those supplied in `transfer_syntax`. To remove</span>
<span class="sd">        a supported context or one or more of its transfer syntaxes see the</span>
<span class="sd">        ``remove_supported_context`` method.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        abstract_syntax : str, pydicom.uid.UID or sop_class.SOPClass</span>
<span class="sd">            The abstract syntax of the presentation context to be supported.</span>
<span class="sd">        transfer_syntax :  str/pydicom.uid.UID or list of str/pydicom.uid.UID</span>
<span class="sd">            The transfer syntax(es) to support (default: Implicit VR Little</span>
<span class="sd">            Endian, Explicit VR Little Endian, Explicit VR Big Endian).</span>
<span class="sd">        scu_role : bool or None, optional</span>
<span class="sd">            If the association requestor includes an SCP/SCU Role Selection</span>
<span class="sd">            Negotiation item for this context then:</span>

<span class="sd">            * If None then ignore the proposal (if either `scp_role` or</span>
<span class="sd">              `scu_role` is None then both are assumed to be) and use the</span>
<span class="sd">              default roles.</span>
<span class="sd">            * If True accept the proposed SCU role</span>
<span class="sd">            * If False reject the proposed SCU role</span>
<span class="sd">        scp_role : bool or None, optional</span>
<span class="sd">            If the association requestor includes an SCP/SCU Role Selection</span>
<span class="sd">            Negotiation item for this context then:</span>

<span class="sd">            * If None then ignore the proposal (if either `scp_role` or</span>
<span class="sd">              `scu_role` is None then both are assumed to be) and use the</span>
<span class="sd">              default roles.</span>
<span class="sd">            * If True accept the proposed SCP role</span>
<span class="sd">            * If False reject the proposed SCP role</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Add support for presentation contexts with an abstract syntax of</span>
<span class="sd">        *Verification SOP Class* and the default transfer syntaxes by using</span>
<span class="sd">        its UID value.</span>

<span class="sd">        &gt;&gt;&gt; from pynetdicom import AE</span>
<span class="sd">        &gt;&gt;&gt; ae = AE()</span>
<span class="sd">        &gt;&gt;&gt; ae.add_supported_context(&#39;1.2.840.10008.1.1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; print(ae.supported_contexts[0])</span>
<span class="sd">        Abstract Syntax: Verification SOP Class</span>
<span class="sd">        Transfer Syntax(es):</span>
<span class="sd">            =Implicit VR Little Endian</span>
<span class="sd">            =Explicit VR Little Endian</span>
<span class="sd">            =Explicit VR Big Endian</span>

<span class="sd">        Add support for presentation contexts with an abstract syntax of</span>
<span class="sd">        *Verification SOP Class* and the default transfer syntaxes by using the</span>
<span class="sd">        inbuilt `VerificationSOPClass` object.</span>

<span class="sd">        &gt;&gt;&gt; from pynetdicom import AE</span>
<span class="sd">        &gt;&gt;&gt; from pynetdicom.sop_class import VerificationSOPClass</span>
<span class="sd">        &gt;&gt;&gt; ae = AE()</span>
<span class="sd">        &gt;&gt;&gt; ae.add_supported_context(VerificationSOPClass)</span>

<span class="sd">        Add support for presentation contexts with an abstract syntax of</span>
<span class="sd">        *Verification SOP Class* and a transfer syntax of *Implicit VR Little</span>
<span class="sd">        Endian*.</span>

<span class="sd">        &gt;&gt;&gt; from pydicom.uid import ImplicitVRLittleEndian</span>
<span class="sd">        &gt;&gt;&gt; from pynetdicom import AE</span>
<span class="sd">        &gt;&gt;&gt; from pynetdicom.sop_class import VerificationSOPClass</span>
<span class="sd">        &gt;&gt;&gt; ae = AE()</span>
<span class="sd">        &gt;&gt;&gt; ae.add_supported_context(VerificationSOPClass,</span>
<span class="sd">        ...                          ImplicitVRLittleEndian)</span>
<span class="sd">        &gt;&gt;&gt; print(ae.supported_contexts[0])</span>
<span class="sd">        Abstract Syntax: Verification SOP Class</span>
<span class="sd">        Transfer Syntax(es):</span>
<span class="sd">            =Implicit VR Little Endian</span>

<span class="sd">        Add support for presentation contexts with an abstract syntax of</span>
<span class="sd">        *Verification SOP Class* and transfer syntaxes of *Implicit VR Little</span>
<span class="sd">        Endian* and *Explicit VR Big Endian* and then update the context to</span>
<span class="sd">        also support *Explicit VR Little Endian*.</span>

<span class="sd">        &gt;&gt;&gt; from pydicom.uid import (</span>
<span class="sd">        ...     ImplicitVRLittleEndian, ExplicitVRLittleEndian,</span>
<span class="sd">        ...     ExplicitVRBigEndian</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; from pynetdicom import AE</span>
<span class="sd">        &gt;&gt;&gt; from pynetdicom.sop_class import VerificationSOPClass</span>
<span class="sd">        &gt;&gt;&gt; ae = AE()</span>
<span class="sd">        &gt;&gt;&gt; ae.add_supported_context(VerificationSOPClass,</span>
<span class="sd">        ...                         [ImplicitVRLittleEndian,</span>
<span class="sd">        ...                          ExplicitVRBigEndian])</span>
<span class="sd">        &gt;&gt;&gt; ae.add_supported_context(VerificationSOPClass,</span>
<span class="sd">        ...                          ExplicitVRLittleEndian)</span>
<span class="sd">        &gt;&gt;&gt; print(ae.supported_contexts[0])</span>
<span class="sd">        Abstract Syntax: Verification SOP Class</span>
<span class="sd">        Transfer Syntax(es):</span>
<span class="sd">            =Implicit VR Little Endian</span>
<span class="sd">            =Explicit VR Little Endian</span>
<span class="sd">            =Explicit VR Big Endian</span>

<span class="sd">        Add support for CTImageStorage and if the association requestor</span>
<span class="sd">        includes an SCP/SCU Role Selection Negotiation item for CT Image</span>
<span class="sd">        Storage requesting the SCU and SCP roles then accept the proposal.</span>

<span class="sd">        &gt;&gt;&gt; from pynetdicom import AE</span>
<span class="sd">        &gt;&gt;&gt; from pynetdicom.sop_class import CTImageStorage</span>
<span class="sd">        &gt;&gt;&gt; ae = AE()</span>
<span class="sd">        &gt;&gt;&gt; ae.add_supported_context(</span>
<span class="sd">        ...     CTImageStorage, scu_role=True, scp_role=True</span>
<span class="sd">        ... )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">transfer_syntax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">transfer_syntax</span> <span class="o">=</span> <span class="n">DEFAULT_TRANSFER_SYNTAXES</span>

        <span class="n">abstract_syntax</span> <span class="o">=</span> <span class="n">UID</span><span class="p">(</span><span class="n">abstract_syntax</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">scu_role</span><span class="p">,</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> <span class="nb">bool</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`scu_role` must be None or bool&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">scp_role</span><span class="p">,</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> <span class="nb">bool</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`scp_role` must be None or bool&quot;</span><span class="p">)</span>

        <span class="c1"># For convenience allow single transfer syntax values</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">transfer_syntax</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">transfer_syntax</span> <span class="o">=</span> <span class="p">[</span><span class="n">transfer_syntax</span><span class="p">]</span>
        <span class="n">transfer_syntax</span> <span class="o">=</span> <span class="p">[</span><span class="n">UID</span><span class="p">(</span><span class="n">syntax</span><span class="p">)</span> <span class="k">for</span> <span class="n">syntax</span> <span class="ow">in</span> <span class="n">transfer_syntax</span><span class="p">]</span>

        <span class="c1"># If the abstract syntax is already supported then update the transfer</span>
        <span class="c1">#   syntaxes</span>
        <span class="k">if</span> <span class="n">abstract_syntax</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_supported_contexts</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_supported_contexts</span><span class="p">[</span><span class="n">abstract_syntax</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">syntax</span> <span class="ow">in</span> <span class="n">transfer_syntax</span><span class="p">:</span>
                <span class="n">context</span><span class="o">.</span><span class="n">add_transfer_syntax</span><span class="p">(</span><span class="n">syntax</span><span class="p">)</span>
            <span class="n">context</span><span class="o">.</span><span class="n">scu_role</span> <span class="o">=</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">scu_role</span>
            <span class="n">context</span><span class="o">.</span><span class="n">scp_role</span> <span class="o">=</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">scp_role</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">PresentationContext</span><span class="p">()</span>
            <span class="n">context</span><span class="o">.</span><span class="n">abstract_syntax</span> <span class="o">=</span> <span class="n">abstract_syntax</span>
            <span class="n">context</span><span class="o">.</span><span class="n">transfer_syntax</span> <span class="o">=</span> <span class="n">transfer_syntax</span>
            <span class="n">context</span><span class="o">.</span><span class="n">scu_role</span> <span class="o">=</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">scu_role</span>
            <span class="n">context</span><span class="o">.</span><span class="n">scp_role</span> <span class="o">=</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">scp_role</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_supported_contexts</span><span class="p">[</span><span class="n">abstract_syntax</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ae_title</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the AE title.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ae_title</span>

    <span class="nd">@ae_title</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">ae_title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the AE title.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : bytes</span>
<span class="sd">            The AE title to use for the local Application Entity. Leading and</span>
<span class="sd">            trailing spaces are non-significant.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># pylint: disable=attribute-defined-outside-init</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ae_title</span> <span class="o">=</span> <span class="n">validate_ae_title</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span>

    <span class="c1"># TODO: refactor in v1.3</span>
<div class="viewcode-block" id="ApplicationEntity.associate"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity.associate">[docs]</a>    <span class="k">def</span> <span class="nf">associate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">contexts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ae_title</span><span class="o">=</span><span class="sa">b</span><span class="s1">&#39;ANY-SCP&#39;</span><span class="p">,</span>
                  <span class="n">max_pdu</span><span class="o">=</span><span class="n">DEFAULT_MAX_LENGTH</span><span class="p">,</span> <span class="n">ext_neg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bind_address</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">tls_args</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Request an Association with a remote AE.</span>

<span class="sd">        The Association thread is returned whether or not the association is</span>
<span class="sd">        accepted and should be checked using ``Association.is_established``</span>
<span class="sd">        before sending any messages. The returned thread will only be running</span>
<span class="sd">        if the association was established.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        addr : str</span>
<span class="sd">            The peer AE&#39;s TCP/IP address.</span>
<span class="sd">        port : int</span>
<span class="sd">            The peer AE&#39;s listen port number.</span>
<span class="sd">        contexts : list of presentation.PresentationContext, optional</span>
<span class="sd">            The presentation contexts that will be requested by the AE for</span>
<span class="sd">            support by the peer. If not used then the presentation contexts in</span>
<span class="sd">            the `AE.requested_contexts` property will be requested instead.</span>
<span class="sd">        ae_title : bytes, optional</span>
<span class="sd">            The peer&#39;s AE title, will be used as the &#39;Called AE Title&#39;</span>
<span class="sd">            parameter value (default b&#39;ANY-SCP&#39;).</span>
<span class="sd">        max_pdu : int, optional</span>
<span class="sd">            The maximum PDV receive size in bytes to use when negotiating the</span>
<span class="sd">            association (default 16832).</span>
<span class="sd">        ext_neg : list of UserInformation objects, optional</span>
<span class="sd">            Used if extended association negotiation is required.</span>
<span class="sd">        bind_address : 2-tuple, optional</span>
<span class="sd">            The (host, port) to bind the Association&#39;s communication socket</span>
<span class="sd">            to. If not used then defaults to (AE.bind_addr, AE.port). After</span>
<span class="sd">            v1.3 it will default to (&#39;&#39;, 0).</span>
<span class="sd">        tls_args : 2-tuple, optional</span>
<span class="sd">            If TLS is required then this should be a 2-tuple containing a</span>
<span class="sd">            (ssl_context, `server_hostname`), where ssl_context is the</span>
<span class="sd">            ssl.SSLContext instance to use to wrap the client socket and</span>
<span class="sd">            `server_hostname` is the value to use for the corresponding</span>
<span class="sd">            keyword parameter in ``SSLContext.wrap_sockets()``. If no</span>
<span class="sd">            `tls_args` is supplied then TLS will not be used (default).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        assoc : association.Association</span>
<span class="sd">            If the association was established then a running Association</span>
<span class="sd">            thread, otherwise returns a thread that hasn&#39;t been started.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If called with no requested presentation contexts (i.e. `contexts`</span>
<span class="sd">            has not been supplied and ``ApplicationEntity.requested_contexts``</span>
<span class="sd">            is empty).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;&#39;addr&#39; must be a valid IPv4 string&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">port</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;&#39;port&#39; must be a valid port number&quot;</span><span class="p">)</span>

        <span class="c1"># AssociationSocket binding</span>
        <span class="k">if</span> <span class="n">bind_address</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Deprecated, after v1.3 this will be (&#39;&#39;, 0)</span>
            <span class="n">bind_address</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bind_addr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">)</span>

        <span class="c1"># Association</span>
        <span class="n">assoc</span> <span class="o">=</span> <span class="n">Association</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">MODE_REQUESTOR</span><span class="p">)</span>

        <span class="c1"># Set the thread name</span>
        <span class="n">timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span> <span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">%H%M%S&quot;</span><span class="p">)</span>
        <span class="n">assoc</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;RequestorThread@</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>

        <span class="c1"># Setup the association&#39;s communication socket</span>
        <span class="n">sock</span> <span class="o">=</span> <span class="n">AssociationSocket</span><span class="p">(</span><span class="n">assoc</span><span class="p">,</span> <span class="n">address</span><span class="o">=</span><span class="n">bind_address</span><span class="p">)</span>
        <span class="n">sock</span><span class="o">.</span><span class="n">tls_args</span> <span class="o">=</span> <span class="n">tls_args</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">assoc</span><span class="o">.</span><span class="n">set_socket</span><span class="p">(</span><span class="n">sock</span><span class="p">)</span>

        <span class="c1"># Association Acceptor object -&gt; remote AE</span>
        <span class="n">assoc</span><span class="o">.</span><span class="n">acceptor</span><span class="o">.</span><span class="n">ae_title</span> <span class="o">=</span> <span class="n">validate_ae_title</span><span class="p">(</span><span class="n">ae_title</span><span class="p">)</span>
        <span class="n">assoc</span><span class="o">.</span><span class="n">acceptor</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">addr</span>
        <span class="n">assoc</span><span class="o">.</span><span class="n">acceptor</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">port</span>

        <span class="c1"># Association Requestor object -&gt; local AE</span>
        <span class="n">assoc</span><span class="o">.</span><span class="n">requestor</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">gethostbyname</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">gethostname</span><span class="p">())</span>
        <span class="n">assoc</span><span class="o">.</span><span class="n">requestor</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">bind_address</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">assoc</span><span class="o">.</span><span class="n">requestor</span><span class="o">.</span><span class="n">ae_title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ae_title</span>
        <span class="n">assoc</span><span class="o">.</span><span class="n">requestor</span><span class="o">.</span><span class="n">maximum_length</span> <span class="o">=</span> <span class="n">max_pdu</span>
        <span class="n">assoc</span><span class="o">.</span><span class="n">requestor</span><span class="o">.</span><span class="n">implementation_class_uid</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">implementation_class_uid</span>
        <span class="p">)</span>
        <span class="n">assoc</span><span class="o">.</span><span class="n">requestor</span><span class="o">.</span><span class="n">implementation_version_name</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">implementation_version_name</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ext_neg</span> <span class="ow">or</span> <span class="p">[]):</span>
            <span class="n">assoc</span><span class="o">.</span><span class="n">requestor</span><span class="o">.</span><span class="n">add_negotiation_item</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

        <span class="c1"># Requestor&#39;s presentation contexts</span>
        <span class="k">if</span> <span class="n">contexts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">contexts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">requested_contexts</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_validate_requested_contexts</span><span class="p">(</span><span class="n">contexts</span><span class="p">)</span>

        <span class="c1"># PS3.8 Table 9.11, an A-ASSOCIATE-RQ must contain one or more</span>
        <span class="c1">#   Presentation Context items</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">contexts</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;At least one requested presentation context is required &quot;</span>
                <span class="s2">&quot;before associating with a peer&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Set using a copy of the original to play nicely</span>
        <span class="n">contexts</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">contexts</span><span class="p">)</span>

        <span class="c1"># Add the context IDs</span>
        <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">context</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">contexts</span><span class="p">):</span>
            <span class="n">context</span><span class="o">.</span><span class="n">context_id</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">ii</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="n">assoc</span><span class="o">.</span><span class="n">requestor</span><span class="o">.</span><span class="n">requested_contexts</span> <span class="o">=</span> <span class="n">contexts</span>

        <span class="c1"># Send an A-ASSOCIATE request to the peer and start negotiation</span>
        <span class="n">assoc</span><span class="o">.</span><span class="n">request</span><span class="p">()</span>

        <span class="c1"># If the result of the negotiation was acceptance then start up</span>
        <span class="c1">#   the Association thread</span>
        <span class="k">if</span> <span class="n">assoc</span><span class="o">.</span><span class="n">is_established</span><span class="p">:</span>
            <span class="n">assoc</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">assoc</span></div>

    <span class="c1"># TODO: remove in v1.3</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">bind_addr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the `bind_addr`, deprecated and will be removd in v1.3.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bind_addr</span>

    <span class="nd">@bind_addr</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">bind_addr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the `bind_addr`, deprecated and will be removd in v1.3.&quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;The `bind_addr` property is deprecated and will &quot;</span>
            <span class="s2">&quot;be removed in v1.3. Use the `address` parameter for &quot;</span>
            <span class="s2">&quot;AE.start_server() or the `bind_address` keyword parameter &quot;</span>
            <span class="s2">&quot;for AE.associate() instead&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bind_addr</span> <span class="o">=</span> <span class="n">addr</span>

    <span class="c1"># TODO: remove in v1.3</span>
    <span class="k">def</span> <span class="nf">_bind_socket</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set up and bind a socket for use with the SCP.&quot;&quot;&quot;</span>
        <span class="c1"># The socket to listen for connections on, port is always specified</span>
        <span class="c1"># AF_INET: IPv4, SOCK_STREAM: TCP socket</span>
        <span class="n">sock</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>

        <span class="c1"># SOL_SOCKET: the level, SO_REUSEADDR: allow reuse of a port</span>
        <span class="c1">#   stuck in TIME_WAIT, 1: set SO_REUSEADDR to 1</span>
        <span class="c1"># This must be called prior to socket.bind()</span>
        <span class="n">sock</span><span class="o">.</span><span class="n">setsockopt</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">SOL_SOCKET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SO_REUSEADDR</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">network_timeout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">timeout_seconds</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">network_timeout</span><span class="p">)</span>
            <span class="n">timeout_microsec</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">network_timeout</span> <span class="o">%</span> <span class="mi">1</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
            <span class="n">sock</span><span class="o">.</span><span class="n">setsockopt</span><span class="p">(</span>
                <span class="n">socket</span><span class="o">.</span><span class="n">SOL_SOCKET</span><span class="p">,</span>
                <span class="n">socket</span><span class="o">.</span><span class="n">SO_RCVTIMEO</span><span class="p">,</span>
                <span class="n">pack</span><span class="p">(</span><span class="s1">&#39;ll&#39;</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="p">,</span> <span class="n">timeout_microsec</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="c1"># Bind the socket to an address and port</span>
        <span class="c1">#   If self.bind_addr is &#39;&#39; then the socket is reachable by any</span>
        <span class="c1">#   address the machine may have, otherwise is visible only on that</span>
        <span class="c1">#   address</span>
        <span class="n">sock</span><span class="o">.</span><span class="n">bind</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">bind_addr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">))</span>

        <span class="c1"># Listen for connections made to the socket</span>
        <span class="c1"># socket.listen() says to queue up to as many as N connect requests</span>
        <span class="c1">#   before refusing outside connections</span>
        <span class="n">sock</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">sock</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dimse_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the DIMSE timeout.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dimse_timeout</span>

    <span class="nd">@dimse_timeout</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">dimse_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the DIMSE timeout in seconds.&quot;&quot;&quot;</span>
        <span class="c1"># pylint: disable=attribute-defined-outside-init</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dimse_timeout</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dimse_timeout</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;dimse_timeout set to 30 s&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dimse_timeout</span> <span class="o">=</span> <span class="mi">30</span>

        <span class="k">for</span> <span class="n">assoc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_associations</span><span class="p">:</span>
            <span class="n">assoc</span><span class="o">.</span><span class="n">dimse_timeout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimse_timeout</span>
            <span class="n">assoc</span><span class="o">.</span><span class="n">dimse</span><span class="o">.</span><span class="n">dimse_timeout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimse_timeout</span>

    <span class="c1"># TODO: remove in v1.3</span>
    <span class="k">def</span> <span class="nf">_handle_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client_socket</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Start a new Association thread to handle the connection request.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        client_socket : socket.socket</span>
<span class="sd">            The socket handling to the connection to the peer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Create a new Association</span>
        <span class="n">assoc</span> <span class="o">=</span> <span class="n">Association</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">MODE_ACCEPTOR</span><span class="p">)</span>

        <span class="c1"># Association Acceptor object -&gt; local AE</span>
        <span class="n">assoc</span><span class="o">.</span><span class="n">acceptor</span><span class="o">.</span><span class="n">maximum_length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maximum_pdu_size</span>
        <span class="n">assoc</span><span class="o">.</span><span class="n">acceptor</span><span class="o">.</span><span class="n">ae_title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ae_title</span>
        <span class="n">assoc</span><span class="o">.</span><span class="n">acceptor</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">address</span>
        <span class="n">assoc</span><span class="o">.</span><span class="n">acceptor</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span>
        <span class="n">assoc</span><span class="o">.</span><span class="n">acceptor</span><span class="o">.</span><span class="n">implementation_class_uid</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">implementation_class_uid</span>
        <span class="p">)</span>
        <span class="n">assoc</span><span class="o">.</span><span class="n">acceptor</span><span class="o">.</span><span class="n">implementation_version_name</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">implementation_version_name</span>
        <span class="p">)</span>
        <span class="n">assoc</span><span class="o">.</span><span class="n">acceptor</span><span class="o">.</span><span class="n">supported_contexts</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">supported_contexts</span>
        <span class="p">)</span>

        <span class="c1"># Association Requestor object -&gt; remote AE</span>
        <span class="n">assoc</span><span class="o">.</span><span class="n">requestor</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">client_socket</span><span class="o">.</span><span class="n">getpeername</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">assoc</span><span class="o">.</span><span class="n">requestor</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">client_socket</span><span class="o">.</span><span class="n">getpeername</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">assoc</span><span class="o">.</span><span class="n">set_socket</span><span class="p">(</span><span class="n">AssociationSocket</span><span class="p">(</span><span class="n">assoc</span><span class="p">,</span> <span class="n">client_socket</span><span class="p">))</span>

        <span class="n">assoc</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">implementation_class_uid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the current Implementation Class UID.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_implementation_uid</span>

    <span class="nd">@implementation_class_uid</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">implementation_class_uid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the Implementation Class UID used in Association requests.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        uid : str or pydicom.uid.UID</span>
<span class="sd">            The A-ASSOCIATE-RQ&#39;s Implementation Class UID value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">uid</span> <span class="o">=</span> <span class="n">UID</span><span class="p">(</span><span class="n">uid</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">uid</span><span class="o">.</span><span class="n">is_valid</span><span class="p">:</span>
            <span class="c1"># pylint: disable=attribute-defined-outside-init</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_implementation_uid</span> <span class="o">=</span> <span class="n">uid</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">implementation_version_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the current Implementation Version Name.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_implementation_version</span>

    <span class="nd">@implementation_version_name</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">implementation_version_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the Implementation Version Name used in Association requests.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : bytes</span>
<span class="sd">            The A-ASSOCIATE-RQ&#39;s Implementation Version Name value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># pylint: disable=attribute-defined-outside-init</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_implementation_version</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">maximum_associations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the number of maximum associations as int.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_maximum_associations</span>

    <span class="nd">@maximum_associations</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">maximum_associations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the number of maximum associations.&quot;&quot;&quot;</span>
        <span class="c1"># pylint: disable=attribute-defined-outside-init</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_maximum_associations</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;maximum_associations set to 1&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_maximum_associations</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">maximum_pdu_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the maximum PDU size accepted by the AE as int.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_maximum_pdu_size</span>

    <span class="nd">@maximum_pdu_size</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">maximum_pdu_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the maximum PDU size.&quot;&quot;&quot;</span>
        <span class="c1"># pylint: disable=attribute-defined-outside-init</span>
        <span class="c1"># Bounds and type checking of the received maximum length of the</span>
        <span class="c1">#   variable field of P-DATA-TF PDUs (in bytes)</span>
        <span class="c1">#   * Must be numerical, greater than or equal to 0 (0 indicates</span>
        <span class="c1">#       no maximum length (PS3.8 Annex D.1.1)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_maximum_pdu_size</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;maximum_pdu_size set to </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">DEFAULT_MAX_LENGTH</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">network_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the network timeout.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_network_timeout</span>

    <span class="nd">@network_timeout</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">network_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the network timeout.&quot;&quot;&quot;</span>
        <span class="c1"># pylint: disable=attribute-defined-outside-init</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_network_timeout</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_network_timeout</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;network_timeout set to 60 s&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_network_timeout</span> <span class="o">=</span> <span class="mi">60</span>

        <span class="k">for</span> <span class="n">assoc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_associations</span><span class="p">:</span>
            <span class="n">assoc</span><span class="o">.</span><span class="n">network_timeout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">network_timeout</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">port</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the port number as an int.</span>

<span class="sd">        This property is deprecated and will be removed in v1.3.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_port</span>

    <span class="nd">@port</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">port</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the port number.</span>

<span class="sd">        This property is deprecated and will be removed in v1.3. Use</span>
<span class="sd">        the ``address`` parameter for ``start_server()`` and the</span>
<span class="sd">        ``bind_address`` keyword parameter for ``associate()`` instead.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;The `port` keyword parameter for AE() is deprecated and will &quot;</span>
            <span class="s2">&quot;be removed in v1.3. Use the `address` parameter for &quot;</span>
            <span class="s2">&quot;AE.start_server() or the `bind_address` keyword parameter &quot;</span>
            <span class="s2">&quot;for AE.associate() instead&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span>
        <span class="p">)</span>
        <span class="c1"># pylint: disable=attribute-defined-outside-init</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_port</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;AE port number must be an integer greater then &quot;</span>
                             <span class="s2">&quot;or equal to 0&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="ApplicationEntity.remove_requested_context"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity.remove_requested_context">[docs]</a>    <span class="k">def</span> <span class="nf">remove_requested_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abstract_syntax</span><span class="p">,</span> <span class="n">transfer_syntax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove a requested Presentation Context.</span>

<span class="sd">        Depending on the supplied parameters one of the following will occur:</span>

<span class="sd">        * `abstract_syntax` alone -  all contexts with a matching abstract</span>
<span class="sd">          syntax all be removed.</span>
<span class="sd">        * `abstract_syntax` and `transfer_syntax` -  for all contexts with a</span>
<span class="sd">          matching abstract syntax; if the supplied `transfer_syntax` list</span>
<span class="sd">          contains all of the context&#39;s requested transfer syntaxes then the</span>
<span class="sd">          entire context will be removed. Otherwise only the matching transfer</span>
<span class="sd">          syntaxes will be removed from the context (and the context will</span>
<span class="sd">          remain with one or more transfer syntaxes).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        abstract_syntax : str, pydicom.uid.UID or sop_class.SOPClass</span>
<span class="sd">            The abstract syntax of the presentation context you wish to stop</span>
<span class="sd">            requesting when sending association requests.</span>
<span class="sd">        transfer_syntax : UID str or list of UID str, optional</span>
<span class="sd">            The transfer syntax(ex) you wish to stop requesting. If a list of</span>
<span class="sd">            str/UID then only those transfer syntaxes specified will no longer</span>
<span class="sd">            be requested. If not specified then the abstract syntax and all</span>
<span class="sd">            associated transfer syntaxes will no longer be requested (default).</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Remove all requested presentation contexts with an abstract syntax of</span>
<span class="sd">        *Verification SOP Class* using its UID value.</span>

<span class="sd">        &gt;&gt;&gt; from pynetdicom import AE</span>
<span class="sd">        &gt;&gt;&gt; ae = AE()</span>
<span class="sd">        &gt;&gt;&gt; ae.add_requested_context(&#39;1.2.840.10008.1.1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; print(ae.reqested_contexts[0])</span>
<span class="sd">        Abstract Syntax: Verification SOP Class</span>
<span class="sd">        Transfer Syntax(es):</span>
<span class="sd">	        =Implicit VR Little Endian</span>
<span class="sd">	        =Explicit VR Little Endian</span>
<span class="sd">	        =Explicit VR Big Endian</span>
<span class="sd">        &gt;&gt;&gt; ae.remove_requested_context(&#39;1.2.840.10008.1.1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; len(ae.requested_contexts)</span>
<span class="sd">        0</span>

<span class="sd">        Remove all requested presentation contexts with an abstract syntax of</span>
<span class="sd">        *Verification SOP Class* using the inbuilt `VerificationSOPClass`</span>
<span class="sd">        object.</span>

<span class="sd">        &gt;&gt;&gt; from pynetdicom import AE</span>
<span class="sd">        &gt;&gt;&gt; from pynetdicom.sop_class import VerificationSOPClass</span>
<span class="sd">        &gt;&gt;&gt; ae = AE()</span>
<span class="sd">        &gt;&gt;&gt; ae.add_requested_context(VerificationSOPClass)</span>
<span class="sd">        &gt;&gt;&gt; ae.remove_requested_context(VerificationSOPClass)</span>
<span class="sd">        &gt;&gt;&gt; len(ae.requested_contexts)</span>
<span class="sd">        0</span>

<span class="sd">        For all requested presentation contexts with an abstract syntax of</span>
<span class="sd">        *Verification SOP Class*, stop requesting a transfer syntax of</span>
<span class="sd">        *Implicit VR Little Endian*. If a presentation context exists which</span>
<span class="sd">        only has a single *Implicit VR Little Endian* transfer syntax then</span>
<span class="sd">        it will be completely removed, otherwise it will be kept with its</span>
<span class="sd">        remaining transfer syntaxes.</span>

<span class="sd">        Presentation context has only a single matching transfer syntax:</span>

<span class="sd">        &gt;&gt;&gt; from pydicom.uid import ImplicitVRLittleEndian</span>
<span class="sd">        &gt;&gt;&gt; from pynetdicom import AE</span>
<span class="sd">        &gt;&gt;&gt; from pynetdicom.sop_class import VerificationSOPClass</span>
<span class="sd">        &gt;&gt;&gt; ae.add_requested_context(VerificationSOPClass,</span>
<span class="sd">        ...                          ImplicitVRLittleEndian)</span>
<span class="sd">        &gt;&gt;&gt; print(ae.requested_contexts[0])</span>
<span class="sd">        Abstract Syntax: Verification SOP Class</span>
<span class="sd">        Transfer Syntax(es):</span>
<span class="sd">	        =Implicit VR Little Endian</span>
<span class="sd">        &gt;&gt;&gt; ae.remove_requested_context(VerificationSOPClass,</span>
<span class="sd">        ...                             ImplicitVRLittleEndian)</span>
<span class="sd">        &gt;&gt;&gt; len(ae.requested_contexts)</span>
<span class="sd">        0</span>

<span class="sd">        Presentation context has at least one remaining transfer syntax:</span>

<span class="sd">        &gt;&gt;&gt; from pydicom.uid import (</span>
<span class="sd">        ...     ImplicitVRLittleEndian, ExplicitVRLittleEndian</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; from pynetdicom import AE</span>
<span class="sd">        &gt;&gt;&gt; from pynetdicom.sop_class import VerificationSOPClass</span>
<span class="sd">        &gt;&gt;&gt; ae = AE()</span>
<span class="sd">        &gt;&gt;&gt; ae.add_requested_context(VerificationSOPClass)</span>
<span class="sd">        &gt;&gt;&gt; print(ae.requested_contexts[0])</span>
<span class="sd">        Abstract Syntax: Verification SOP Class</span>
<span class="sd">        Transfer Syntax(es):</span>
<span class="sd">	        =Implicit VR Little Endian</span>
<span class="sd">	        =Explicit VR Little Endian</span>
<span class="sd">	        =Explicit VR Big Endian</span>
<span class="sd">        &gt;&gt;&gt; ae.remove_requested_context(VerificationSOPClass,</span>
<span class="sd">        ...                             [ImplicitVRLittleEndian,</span>
<span class="sd">        ...                              ExplicitVRLittleEndian])</span>
<span class="sd">        &gt;&gt;&gt; print(ae.requested_contexts[0])</span>
<span class="sd">        Abstract Syntax: Verification SOP Class</span>
<span class="sd">        Transfer Syntax(es):</span>
<span class="sd">	        =Explicit VR Big Endian</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">abstract_syntax</span> <span class="o">=</span> <span class="n">UID</span><span class="p">(</span><span class="n">abstract_syntax</span><span class="p">)</span>

        <span class="c1"># Get all the current requested contexts with the same abstract syntax</span>
        <span class="n">matching_contexts</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">cntx</span> <span class="k">for</span> <span class="n">cntx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">requested_contexts</span>
            <span class="k">if</span> <span class="n">cntx</span><span class="o">.</span><span class="n">abstract_syntax</span> <span class="o">==</span> <span class="n">abstract_syntax</span>
        <span class="p">]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">transfer_syntax</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">transfer_syntax</span> <span class="o">=</span> <span class="p">[</span><span class="n">transfer_syntax</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">transfer_syntax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># If no transfer_syntax then remove the context completely</span>
            <span class="k">for</span> <span class="n">context</span> <span class="ow">in</span> <span class="n">matching_contexts</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_requested_contexts</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">context</span> <span class="ow">in</span> <span class="n">matching_contexts</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">tsyntax</span> <span class="ow">in</span> <span class="n">transfer_syntax</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">tsyntax</span> <span class="ow">in</span> <span class="n">context</span><span class="o">.</span><span class="n">transfer_syntax</span><span class="p">:</span>
                        <span class="n">context</span><span class="o">.</span><span class="n">transfer_syntax</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">UID</span><span class="p">(</span><span class="n">tsyntax</span><span class="p">))</span>

                <span class="c1"># Only if all transfer syntaxes have been removed then</span>
                <span class="c1">#   remove the context</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">context</span><span class="o">.</span><span class="n">transfer_syntax</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_requested_contexts</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">context</span><span class="p">)</span></div>

<div class="viewcode-block" id="ApplicationEntity.remove_supported_context"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity.remove_supported_context">[docs]</a>    <span class="k">def</span> <span class="nf">remove_supported_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abstract_syntax</span><span class="p">,</span> <span class="n">transfer_syntax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove a supported presentation context.</span>

<span class="sd">        Depending on the supplied parameters one of the following will occur:</span>

<span class="sd">        * `abstract_syntax` alone-  the entire supported context will be</span>
<span class="sd">          removed.</span>
<span class="sd">        * `abstract_syntax` and `transfer_syntax` -  If the supplied</span>
<span class="sd">          `transfer_syntax` list contains all of the context&#39;s supported</span>
<span class="sd">          transfer syntaxes then the entire context will be removed.</span>
<span class="sd">          Otherwise only the matching transfer syntaxes will be removed from</span>
<span class="sd">          the context (and the context will remain with one or more transfer</span>
<span class="sd">          syntaxes).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        abstract_syntax : str, pydicom.uid.UID or sop_class.SOPClass</span>
<span class="sd">            The abstract syntax of the presentation context you wish to stop</span>
<span class="sd">            supporting.</span>
<span class="sd">        transfer_syntax : UID str or list of UID str, optional</span>
<span class="sd">            The transfer syntax(ex) you wish to stop supporting. If a list of</span>
<span class="sd">            str/UID then only those transfer syntaxes specified will no longer</span>
<span class="sd">            be supported. If not specified then the abstract syntax and all</span>
<span class="sd">            associated transfer syntaxes will no longer be supported (default).</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Remove the supported presentation context with an abstract syntax of</span>
<span class="sd">        *Verification SOP Class* using its UID value.</span>

<span class="sd">        &gt;&gt;&gt; from pynetdicom import AE</span>
<span class="sd">        &gt;&gt;&gt; ae = AE()</span>
<span class="sd">        &gt;&gt;&gt; ae.add_supported_context(&#39;1.2.840.10008.1.1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; print(ae.supported_contexts[0])</span>
<span class="sd">        Abstract Syntax: Verification SOP Class</span>
<span class="sd">        Transfer Syntax(es):</span>
<span class="sd">	        =Implicit VR Little Endian</span>
<span class="sd">	        =Explicit VR Little Endian</span>
<span class="sd">	        =Explicit VR Big Endian</span>
<span class="sd">        &gt;&gt;&gt; ae.remove_supported_context(&#39;1.2.840.10008.1.1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; len(ae.supported_contexts)</span>
<span class="sd">        0</span>

<span class="sd">        Remove the supported presentation context with an abstract syntax of</span>
<span class="sd">        *Verification SOP Class* using the inbuilt `VerificationSOPClass`</span>
<span class="sd">        object.</span>

<span class="sd">        &gt;&gt;&gt; from pynetdicom import AE, VerificationPresentationContexts</span>
<span class="sd">        &gt;&gt;&gt; from pynetdicom.sop_class import VerificationSOPClass</span>
<span class="sd">        &gt;&gt;&gt; ae = AE()</span>
<span class="sd">        &gt;&gt;&gt; ae.supported_contexts = VerificationPresentationContexts</span>
<span class="sd">        &gt;&gt;&gt; ae.remove_supported_context(VerificationSOPClass)</span>

<span class="sd">        For the presentation contexts with an abstract syntax of</span>
<span class="sd">        *Verification SOP Class*, stop supporting the *Implicit VR Little</span>
<span class="sd">        Endian* transfer syntax. If the presentation context only has the</span>
<span class="sd">        single *Implicit VR Little Endian* transfer syntax then it will be</span>
<span class="sd">        completely removed, otherwise it will be kept with the remaining</span>
<span class="sd">        transfer syntaxes.</span>

<span class="sd">        Presentation context has only a single matching transfer syntax:</span>

<span class="sd">        &gt;&gt;&gt; from pydicom.uid import ImplicitVRLittleEndian</span>
<span class="sd">        &gt;&gt;&gt; from pynetdicom import AE</span>
<span class="sd">        &gt;&gt;&gt; from pynetdicom.sop_class import VerificationSOPClass</span>
<span class="sd">        &gt;&gt;&gt; ae = AE()</span>
<span class="sd">        &gt;&gt;&gt; ae.add_supported_context(VerificationSOPClass,</span>
<span class="sd">        ...                          ImplicitVRLittleEndian)</span>
<span class="sd">        &gt;&gt;&gt; print(ae.supported_contexts[0])</span>
<span class="sd">        Abstract Syntax: Verification SOP Class</span>
<span class="sd">        Transfer Syntax(es):</span>
<span class="sd">	        =Implicit VR Little Endian</span>
<span class="sd">        &gt;&gt;&gt; ae.remove_supported_context(VerificationSOPClass,</span>
<span class="sd">        ...                             ImplicitVRLittleEndian)</span>
<span class="sd">        &gt;&gt;&gt; len(ae.supported_contexts)</span>
<span class="sd">        0</span>

<span class="sd">        Presentation context has at least one remaining transfer syntax:</span>

<span class="sd">        &gt;&gt;&gt; from pydicom.uid import (</span>
<span class="sd">        ...     ImplicitVRLittleEndian, ExplicitVRLittleEndian</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; from pynetdicom import AE</span>
<span class="sd">        &gt;&gt;&gt; from pynetdicom.sop_class import VerificationSOPClass</span>
<span class="sd">        &gt;&gt;&gt; ae = AE()</span>
<span class="sd">        &gt;&gt;&gt; ae.add_supported_context(VerificationSOPClass)</span>
<span class="sd">        &gt;&gt;&gt; print(ae.supported_contexts[0])</span>
<span class="sd">        Abstract Syntax: Verification SOP Class</span>
<span class="sd">        Transfer Syntax(es):</span>
<span class="sd">	        =Implicit VR Little Endian</span>
<span class="sd">	        =Explicit VR Little Endian</span>
<span class="sd">	        =Explicit VR Big Endian</span>
<span class="sd">        &gt;&gt;&gt; ae.remove_supported_context(VerificationSOPClass,</span>
<span class="sd">        ...                             [ImplicitVRLittleEndian,</span>
<span class="sd">        ...                              ExplicitVRLittleEndian])</span>
<span class="sd">        &gt;&gt;&gt; print(ae.supported_contexts[0])</span>
<span class="sd">        Abstract Syntax: Verification SOP Class</span>
<span class="sd">        Transfer Syntax(es):</span>
<span class="sd">	        =Explicit VR Big Endian</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">abstract_syntax</span> <span class="o">=</span> <span class="n">UID</span><span class="p">(</span><span class="n">abstract_syntax</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">transfer_syntax</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">transfer_syntax</span> <span class="o">=</span> <span class="p">[</span><span class="n">transfer_syntax</span><span class="p">]</span>

        <span class="c1"># Check abstract syntax is actually present</span>
        <span class="c1">#   we don&#39;t warn if not present because by not being present its not</span>
        <span class="c1">#   supported and hence the user&#39;s intent has been satisfied</span>
        <span class="k">if</span> <span class="n">abstract_syntax</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_supported_contexts</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">transfer_syntax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># If no transfer_syntax then remove the context completely</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_supported_contexts</span><span class="p">[</span><span class="n">abstract_syntax</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># If transfer_syntax then only remove matching syntaxes</span>
                <span class="n">context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_supported_contexts</span><span class="p">[</span><span class="n">abstract_syntax</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">tsyntax</span> <span class="ow">in</span> <span class="n">transfer_syntax</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">tsyntax</span> <span class="ow">in</span> <span class="n">context</span><span class="o">.</span><span class="n">transfer_syntax</span><span class="p">:</span>
                        <span class="n">context</span><span class="o">.</span><span class="n">transfer_syntax</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">UID</span><span class="p">(</span><span class="n">tsyntax</span><span class="p">))</span>

                <span class="c1"># Only if all transfer syntaxes have been removed then remove</span>
                <span class="c1">#   the context</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">context</span><span class="o">.</span><span class="n">transfer_syntax</span><span class="p">:</span>
                    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_supported_contexts</span><span class="p">[</span><span class="n">abstract_syntax</span><span class="p">]</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">requested_contexts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a list of the requested PresentationContext items.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list of presentation.PresentationContext</span>
<span class="sd">            The SCU&#39;s requested Presentation Contexts.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_requested_contexts</span>

    <span class="nd">@requested_contexts</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">requested_contexts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contexts</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the requested Presentation Contexts using a list.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        contexts : list of presentation.PresentationContext</span>
<span class="sd">            The Presentation Contexts to request when acting as an SCU.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Set the requested presentation contexts using an inbuilt list of service</span>
<span class="sd">        specific `PresentationContext` items:</span>

<span class="sd">        &gt;&gt;&gt; from pynetdicom import AE, StoragePresentationContexts</span>
<span class="sd">        &gt;&gt;&gt; ae = AE()</span>
<span class="sd">        &gt;&gt;&gt; ae.requested_contexts = StoragePresentationContexts</span>

<span class="sd">        Set the requested presentation contexts using a list of</span>
<span class="sd">        `PresentationContext` items:</span>

<span class="sd">        &gt;&gt;&gt; from pydicom.uid import ImplicitVRLittleEndian</span>
<span class="sd">        &gt;&gt;&gt; from pynetdicom import AE</span>
<span class="sd">        &gt;&gt;&gt; from pynetdicom.presentation import PresentationContext</span>
<span class="sd">        &gt;&gt;&gt; context = PresentationContext()</span>
<span class="sd">        &gt;&gt;&gt; context.abstract_syntax = &#39;1.2.840.10008.1.1&#39;</span>
<span class="sd">        &gt;&gt;&gt; context.transfer_syntax = [ImplicitVRLittleEndian]</span>
<span class="sd">        &gt;&gt;&gt; ae = AE()</span>
<span class="sd">        &gt;&gt;&gt; ae.requested_contexts = [context]</span>
<span class="sd">        &gt;&gt;&gt; print(ae.requested_contexts[0])</span>
<span class="sd">        Abstract Syntax: Verification SOP Class</span>
<span class="sd">        Transfer Syntax(es):</span>
<span class="sd">            =Implicit VR Little Endian</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If trying to add more than 128 requested presentation contexts.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        ApplicationEntity.add_requested_context</span>
<span class="sd">            Add a single presentation context to the requested contexts using</span>
<span class="sd">            an abstract syntax and (optionally) a list of transfer syntaxes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">contexts</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_requested_contexts</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_requested_contexts</span><span class="p">(</span><span class="n">contexts</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">context</span> <span class="ow">in</span> <span class="n">contexts</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_requested_context</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">abstract_syntax</span><span class="p">,</span>
                                       <span class="n">context</span><span class="o">.</span><span class="n">transfer_syntax</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">require_called_aet</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return whether the *Called AE Title* must match ae_title.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_require_called_aet</span>

    <span class="nd">@require_called_aet</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">require_called_aet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">require_match</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set whether the *Called AE Title* must match the AE title.</span>

<span class="sd">        When an Association request is received the value of the &#39;Called AE</span>
<span class="sd">        Title&#39; supplied by the peer will be compared with the set values and</span>
<span class="sd">        if none match the association will be rejected. If the set value</span>
<span class="sd">        is an empty list then the &#39;Called AE Title&#39; will not be checked.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        require_match : bool</span>
<span class="sd">            If True then any association requests that supply a</span>
<span class="sd">            *Called AE Title* value that does not match AE.ae_title</span>
<span class="sd">            will be rejected. If False (default) then all association requests</span>
<span class="sd">            will be accepted (unless rejected for other reasons).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># pylint: disable=attribute-defined-outside-init</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_require_called_aet</span> <span class="o">=</span> <span class="n">require_match</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">require_calling_aet</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the required calling AE title as a list of bytes.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_require_calling_aet</span>

    <span class="nd">@require_calling_aet</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">require_calling_aet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ae_titles</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the required calling AE title.</span>

<span class="sd">        When an Association request is received the value of the &#39;Calling AE</span>
<span class="sd">        Title&#39; supplied by the peer will be compared with the set value and</span>
<span class="sd">        if none match the association will be rejected. If the set value</span>
<span class="sd">        is an empty list then the &#39;Calling AE Title&#39; will not be checked.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ae_titles : list of bytes</span>
<span class="sd">            If not empty then any association requests that supply a</span>
<span class="sd">            Calling AE Title value that does not match one of the values in</span>
<span class="sd">            `ae_titles` will be rejected. If an empty list (default) then all</span>
<span class="sd">            association requests will be accepted (unless rejected for other</span>
<span class="sd">            reasons).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># pylint: disable=attribute-defined-outside-init</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_require_calling_aet</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">validate_ae_title</span><span class="p">(</span><span class="n">aet</span><span class="p">)</span> <span class="k">for</span> <span class="n">aet</span> <span class="ow">in</span> <span class="n">ae_titles</span>
        <span class="p">]</span>

    <span class="c1"># TODO: remove in v1.3</span>
<div class="viewcode-block" id="ApplicationEntity.start"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity.start">[docs]</a>    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">select_timeout</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Start the AE as an SCP.</span>

<span class="sd">        When running the AE as an SCP this needs to be called to start the main</span>
<span class="sd">        loop, it listens for connections on `local_socket` and if they request</span>
<span class="sd">        association starts a new Association thread</span>

<span class="sd">        This method is deprecated and will be removed in v1.3. Use</span>
<span class="sd">        ``start_server()`` instead.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        select_timeout : float or None, optional</span>
<span class="sd">            The timeout (in seconds) that the select.select() call will block</span>
<span class="sd">            for (default 0.5). A value of 0 specifies a poll and never blocks.</span>
<span class="sd">            A value of None blocks until a connection is ready.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;start() is deprecated and will be removed in v1.3. Use &quot;</span>
            <span class="s2">&quot;start_server() instead&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_quit</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># If the SCP has no supported SOP Classes then there&#39;s no point</span>
        <span class="c1">#   running as a server</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">supported_contexts</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;No supported Presentation Contexts have been defined&quot;</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="n">bad_contexts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">cx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">supported_contexts</span><span class="p">:</span>
            <span class="n">roles</span> <span class="o">=</span> <span class="p">(</span><span class="n">cx</span><span class="o">.</span><span class="n">scu_role</span><span class="p">,</span> <span class="n">cx</span><span class="o">.</span><span class="n">scp_role</span><span class="p">)</span>
            <span class="k">if</span> <span class="kc">None</span> <span class="ow">in</span> <span class="n">roles</span> <span class="ow">and</span> <span class="n">roles</span> <span class="o">!=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
                <span class="n">bad_contexts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cx</span><span class="o">.</span><span class="n">abstract_syntax</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">bad_contexts</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;The following presentation contexts have inconsistent &quot;</span>
                <span class="s2">&quot;scu_role/scp_role values (if one is None, both must be):</span><span class="se">\n</span><span class="s2">  &quot;</span>
            <span class="p">)</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">  &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bad_contexts</span><span class="p">)</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># Bind `sock` to the specified listen port</span>
        <span class="n">sock</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bind_socket</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">local_socket</span> <span class="o">=</span> <span class="n">sock</span>

        <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_quit</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Returns a list if `sock` has data available</span>
                <span class="c1">#   readable, writeable, exceptional</span>
                <span class="c1"># `select_timeout` specifies that select blocks for</span>
                <span class="c1">#   that many seconds before allowing the SCP to be killed</span>
                <span class="n">ready</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">select</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="n">sock</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="n">select_timeout</span><span class="p">)</span>

                <span class="c1"># We check self._quit in case the kill came in during select()</span>
                <span class="k">if</span> <span class="n">ready</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_quit</span><span class="p">:</span>
                    <span class="c1"># socket.accept() blocks until a connection is available</span>
                    <span class="n">client_socket</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">sock</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>

                    <span class="c1"># Start a new association (as acceptor)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_handle_connection</span><span class="p">(</span><span class="n">client_socket</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span></div>

<div class="viewcode-block" id="ApplicationEntity.start_server"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity.start_server">[docs]</a>    <span class="k">def</span> <span class="nf">start_server</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">block</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ssl_context</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Start the AE as an association acceptor.</span>

<span class="sd">        If set to non-blocking then a running ``ThreadedAssociationServer``</span>
<span class="sd">        instance will be returned. This can be stopped using ``shutdown()``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        address : 2-tuple</span>
<span class="sd">            The (host, port) to use when listening for incoming association</span>
<span class="sd">            requests.</span>
<span class="sd">        block : bool, optional</span>
<span class="sd">            If True (default) then the server will be blocking, otherwise it</span>
<span class="sd">            will start the server in a new thread and be non-blocking.</span>
<span class="sd">        ssl_context : ssl.SSLContext, optional</span>
<span class="sd">            If TLS is required then this should the SSLContext instance to</span>
<span class="sd">            use to wrap the client sockets, otherwise if None then no TLS will</span>
<span class="sd">            be used (default).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        transport.ThreadedAssociationServer or None</span>
<span class="sd">            If `block` is False then returns the server instance, otherwise</span>
<span class="sd">            returns None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># If the SCP has no supported SOP Classes then there&#39;s no point</span>
        <span class="c1">#   running as a server</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">supported_contexts</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;No supported Presentation Contexts have been defined&quot;</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="n">bad_contexts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">cx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">supported_contexts</span><span class="p">:</span>
            <span class="n">roles</span> <span class="o">=</span> <span class="p">(</span><span class="n">cx</span><span class="o">.</span><span class="n">scu_role</span><span class="p">,</span> <span class="n">cx</span><span class="o">.</span><span class="n">scp_role</span><span class="p">)</span>
            <span class="k">if</span> <span class="kc">None</span> <span class="ow">in</span> <span class="n">roles</span> <span class="ow">and</span> <span class="n">roles</span> <span class="o">!=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
                <span class="n">bad_contexts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cx</span><span class="o">.</span><span class="n">abstract_syntax</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">bad_contexts</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;The following presentation contexts have inconsistent &quot;</span>
                <span class="s2">&quot;scu_role/scp_role values (if one is None, both must be):</span><span class="se">\n</span><span class="s2">  &quot;</span>
            <span class="p">)</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">  &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bad_contexts</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">block</span><span class="p">:</span>
            <span class="n">server</span> <span class="o">=</span> <span class="n">AssociationServer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">ssl_context</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_servers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">server</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># **BLOCKING**</span>
                <span class="n">server</span><span class="o">.</span><span class="n">serve_forever</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
                <span class="n">server</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Non-blocking server</span>
            <span class="n">timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span> <span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">%H%M%S&quot;</span><span class="p">)</span>
            <span class="n">server</span> <span class="o">=</span> <span class="n">ThreadedAssociationServer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">ssl_context</span><span class="p">)</span>
            <span class="n">thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span>
                <span class="n">target</span><span class="o">=</span><span class="n">server</span><span class="o">.</span><span class="n">serve_forever</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;AcceptorServer@</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">thread</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_servers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">server</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">server</span></div>

    <span class="c1"># TODO: remove in v1.3</span>
<div class="viewcode-block" id="ApplicationEntity.stop"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity.stop">[docs]</a>    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Stop the SCP.</span>

<span class="sd">        When running as an SCP, calling stop() will kill all associations</span>
<span class="sd">        and close the listen socket.</span>

<span class="sd">        This method is deprecated and will be removed in v1.3. Use</span>
<span class="sd">        ``shutdown()`` instead.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;stop() is deprecated and will be removed in v1.3. Use &quot;</span>
            <span class="s2">&quot;shutdown() instead&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_quit</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">local_socket</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">local_socket</span><span class="o">.</span><span class="n">shutdown</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">SHUT_RDWR</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">local_socket</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">local_socket</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span></div>

<div class="viewcode-block" id="ApplicationEntity.shutdown"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity.shutdown">[docs]</a>    <span class="k">def</span> <span class="nf">shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Stop any active association servers and threads.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">assoc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_associations</span><span class="p">:</span>
            <span class="n">assoc</span><span class="o">.</span><span class="n">abort</span><span class="p">()</span>

        <span class="c1"># This is a bit hackish: server.shutdown() deletes the server</span>
        <span class="c1">#   from `_servers` so we need to workaround this</span>
        <span class="n">original</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_servers</span><span class="p">[:]</span>
        <span class="k">for</span> <span class="n">server</span> <span class="ow">in</span> <span class="n">original</span><span class="p">:</span>
            <span class="n">server</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_servers</span> <span class="o">=</span> <span class="p">[]</span></div>

    <span class="c1"># TODO: refactor in v1.3</span>
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Prints out the attribute values and status for the AE &quot;&quot;&quot;</span>
        <span class="n">str_out</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;Application Entity &#39;</span><span class="si">{0!s}</span><span class="s2">&#39; on </span><span class="si">{1!s}</span><span class="s2">:</span><span class="si">{2!s}</span><span class="se">\n</span><span class="s2">&quot;</span> \
                   <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ae_title</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">)</span>

        <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;  Requested Presentation Contexts:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">requested_contexts</span><span class="p">:</span>
            <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">None</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">context</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">requested_contexts</span><span class="p">:</span>
            <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="si">{0!s}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">abstract_syntax</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">transfer_syntax</span> <span class="ow">in</span> <span class="n">context</span><span class="o">.</span><span class="n">transfer_syntax</span><span class="p">:</span>
                <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="si">{0!s}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">transfer_syntax</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;  Supported Presentation Contexts:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">supported_contexts</span><span class="p">:</span>
            <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">None</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">context</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">supported_contexts</span><span class="p">:</span>
            <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="si">{0!s}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">abstract_syntax</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">transfer_syntax</span> <span class="ow">in</span> <span class="n">context</span><span class="o">.</span><span class="n">transfer_syntax</span><span class="p">:</span>
                <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="si">{0!s}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">transfer_syntax</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;  ACSE timeout: </span><span class="si">{0!s}</span><span class="s2"> s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">acse_timeout</span><span class="p">)</span>
        <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;  DIMSE timeout: </span><span class="si">{0!s}</span><span class="s2"> s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimse_timeout</span><span class="p">)</span>
        <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;  Network timeout: </span><span class="si">{0!s}</span><span class="s2"> s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">network_timeout</span><span class="p">)</span>

        <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">require_calling_aet</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="n">ae_titles</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">aet</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">aet</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">require_calling_aet</span>
            <span class="p">]</span>
            <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;  Required calling AE title(s): </span><span class="si">{0!s}</span><span class="se">\n</span><span class="s2">&quot;</span> \
                       <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ae_titles</span><span class="p">))</span>
        <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;  Require called AE title: </span><span class="si">{0!s}</span><span class="se">\n</span><span class="s2">&quot;</span> \
                   <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">require_called_aet</span><span class="p">)</span>

        <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="c1"># Association information</span>
        <span class="n">str_out</span> <span class="o">+=</span> <span class="s1">&#39;  Association(s): </span><span class="si">{0!s}</span><span class="s1">/</span><span class="si">{1!s}</span><span class="se">\n</span><span class="s1">&#39;</span> \
                   <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">active_associations</span><span class="p">),</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">maximum_associations</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">assoc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_associations</span><span class="p">:</span>
            <span class="n">str_out</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Peer: </span><span class="si">{0!s}</span><span class="s1"> on </span><span class="si">{1!s}</span><span class="s1">:</span><span class="si">{2!s}</span><span class="se">\n</span><span class="s1">&#39;</span> \
                       <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">assoc</span><span class="o">.</span><span class="n">remote</span><span class="p">[</span><span class="s1">&#39;ae_title&#39;</span><span class="p">],</span>
                               <span class="n">assoc</span><span class="o">.</span><span class="n">remote</span><span class="p">[</span><span class="s1">&#39;address&#39;</span><span class="p">],</span>
                               <span class="n">assoc</span><span class="o">.</span><span class="n">remote</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">str_out</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">supported_contexts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a list of the supported PresentationContexts items.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list of presentation.PresentationContext</span>
<span class="sd">            The SCP&#39;s supported Presentation Contexts, ordered by abstract</span>
<span class="sd">            syntax.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># The supported presentation contexts are stored internally as a dict</span>
        <span class="n">contexts</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_supported_contexts</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
                          <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">cntx</span><span class="p">:</span> <span class="n">cntx</span><span class="o">.</span><span class="n">abstract_syntax</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">contexts</span>

    <span class="nd">@supported_contexts</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">supported_contexts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contexts</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the supported Presentation Contexts using a list.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        contexts : list of presentation.PresentationContext</span>
<span class="sd">            The Presentation Contexts to support when acting as an SCP.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Set the supported presentation contexts using a list of</span>
<span class="sd">        `PresentationContext` items:</span>

<span class="sd">        &gt;&gt;&gt; from pydicom.uid import ImplicitVRLittleEndian</span>
<span class="sd">        &gt;&gt;&gt; from pynetdicom import AE</span>
<span class="sd">        &gt;&gt;&gt; from pynetdicom.presentation import PresentationContext</span>
<span class="sd">        &gt;&gt;&gt; context = PresentationContext()</span>
<span class="sd">        &gt;&gt;&gt; context.abstract_syntax = &#39;1.2.840.10008.1.1&#39;</span>
<span class="sd">        &gt;&gt;&gt; context.transfer_syntax = [ImplicitVRLittleEndian]</span>
<span class="sd">        &gt;&gt;&gt; ae = AE()</span>
<span class="sd">        &gt;&gt;&gt; ae.supported_contexts = [context]</span>

<span class="sd">        Set the supported presentation contexts using an inbuilt list of service</span>
<span class="sd">        specific `PresentationContext` items:</span>

<span class="sd">        &gt;&gt;&gt; from pynetdicom import AE, StoragePresentationContexts</span>
<span class="sd">        &gt;&gt;&gt; ae = AE()</span>
<span class="sd">        &gt;&gt;&gt; ae.supported_contexts = StoragePresentationContexts</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        ApplicationEntity.add_supported_context</span>
<span class="sd">            Add a single presentation context to the supported contexts using</span>
<span class="sd">            an abstract syntax and optionally a list of transfer syntaxes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">contexts</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_supported_contexts</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">contexts</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">PresentationContext</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;&#39;contexts&#39; must be a list of PresentationContext items&quot;</span>
                <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">add_supported_context</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">abstract_syntax</span><span class="p">,</span>
                                       <span class="n">item</span><span class="o">.</span><span class="n">transfer_syntax</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_validate_requested_contexts</span><span class="p">(</span><span class="n">contexts</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Validate the supplied `contexts`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        contexts : list of presentation.PresentationContext</span>
<span class="sd">            The contexts to validate.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">contexts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">128</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;The maximum allowed number of requested presentation contexts &quot;</span>
                <span class="s2">&quot;is 128&quot;</span>
            <span class="p">)</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">contexts</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">PresentationContext</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;&#39;contexts&#39; must be a list of PresentationContext items&quot;</span>
                <span class="p">)</span>


    <span class="c1"># Association extended negotiation callbacks</span>
    <span class="c1"># pylint: disable=unused-argument,no-self-use</span>
<div class="viewcode-block" id="ApplicationEntity.on_async_ops_window"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity.on_async_ops_window">[docs]</a>    <span class="k">def</span> <span class="nf">on_async_ops_window</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nr_invoked</span><span class="p">,</span> <span class="n">nr_performed</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when an Asynchronous Operations Window Negotiation</span>
<span class="sd">        item is include in the association request.</span>

<span class="sd">        Asynchronous operations are not supported by pynetdicom and any</span>
<span class="sd">        request will always return the default number of operations</span>
<span class="sd">        invoked/performed (1, 1), regardless of what values are returned by</span>
<span class="sd">        this callback.</span>

<span class="sd">        If the callback is not implemented then no response to the Asynchronous</span>
<span class="sd">        Operations Window Negotiation will be sent to the association</span>
<span class="sd">        requestor.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        nr_invoked : int</span>
<span class="sd">            The *Maximum Number Operations Invoked* parameter value of the</span>
<span class="sd">            Asynchronous Operations Window request. If the value is 0 then</span>
<span class="sd">            an unlimited number of invocations are requested.</span>
<span class="sd">        nr_performed : int</span>
<span class="sd">            The *Maximum Number Operations Performed* parameter value of the</span>
<span class="sd">            Asynchronous Operations Window request. If the value is 0 then</span>
<span class="sd">            an unlimited number of performances are requested.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int, int</span>
<span class="sd">            The (maximum number operations invoked, maximum number operations</span>
<span class="sd">            performed). A value of 0 indicates that an unlimited number of</span>
<span class="sd">            operations is supported. As asynchronous operations are not</span>
<span class="sd">            currently supported the return value will be ignored and (1, 1).</span>
<span class="sd">            sent in response.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">&quot;No Asynchronous Operations Window Negotiation response will be &quot;</span>
            <span class="s2">&quot;sent&quot;</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_sop_class_common_extended"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity.on_sop_class_common_extended">[docs]</a>    <span class="k">def</span> <span class="nf">on_sop_class_common_extended</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when one or more SOP Class Common Extended Negotiation</span>
<span class="sd">        items are included in the association request.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        items : dict</span>
<span class="sd">            The {*SOP Class UID* : SOPClassCommonExtendedNegotiation} items</span>
<span class="sd">            sent by the requestor.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            The {*SOP Class UID* : SOPClassCommonExtendedNegotiation}</span>
<span class="sd">            accepted by the acceptor. When receiving DIMSE messages containing</span>
<span class="sd">            datasets corresponding to the SOP Class UID in an accepted item</span>
<span class="sd">            the corresponding Service Class will be used.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        * DICOM Standard Part 7, `Annex D.3.3.6 &lt;http://dicom.nema.org/medical/dicom/current/output/chtml/part07/sect_D.3.3.6.html&gt;`_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{}</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_sop_class_extended"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity.on_sop_class_extended">[docs]</a>    <span class="k">def</span> <span class="nf">on_sop_class_extended</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_info</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when one or more SOP Class Extended Negotiation items</span>
<span class="sd">        are included in the association request.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        app_info : dict of pydicom.uid.UID, bytes</span>
<span class="sd">            The {*SOP Class UID* : *Service Class Application Information*}</span>
<span class="sd">            parameter values for the included items, with the service class</span>
<span class="sd">            application information being the raw encoded data sent by the</span>
<span class="sd">            requestor.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict of pydicom.uid.UID, bytes or None</span>
<span class="sd">            The {*SOP Class UID* : *Service Class Application Information*}</span>
<span class="sd">            parameter values to be sent in response to the request, with the</span>
<span class="sd">            service class application information being the encoded data that</span>
<span class="sd">            will be sent to the peer as-is. Return None if no response is to</span>
<span class="sd">            be sent.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        * DICOM Standard Part 7, `Annex D.3.3.5 &lt;http://dicom.nema.org/medical/dicom/current/output/chtml/part07/sect_D.3.3.5.html&gt;`_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_user_identity"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity.on_user_identity">[docs]</a>    <span class="k">def</span> <span class="nf">on_user_identity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id_type</span><span class="p">,</span> <span class="n">primary_field</span><span class="p">,</span>
                         <span class="n">secondary_field</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when a user identity negotiation item is included with</span>
<span class="sd">        the association request.</span>

<span class="sd">        If not implemented by the user then the association will be accepted</span>
<span class="sd">        (provided there&#39;s no other reason to reject it) and no User Identity</span>
<span class="sd">        response will be sent even if one is requested.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        user_id_type : int</span>
<span class="sd">            The *User Identity Type* value, which indicates the form of user</span>
<span class="sd">            identity being provided:</span>

<span class="sd">            * 1 - Username as a UTF-8 string</span>
<span class="sd">            * 2 - Username as a UTF-8 string and passcode</span>
<span class="sd">            * 3 - Kerberos Service ticket</span>
<span class="sd">            * 4 - SAML Assertion</span>
<span class="sd">            * 5 - JSON Web Token</span>
<span class="sd">        primary_field : bytes</span>
<span class="sd">            The *Primary Field* value, contains the username, the encoded</span>
<span class="sd">            Kerberos ticket or the JSON web token.</span>
<span class="sd">        secondary_field : bytes or None</span>
<span class="sd">            The *Secondary Field* value. Will be ``None`` unless the</span>
<span class="sd">            `user_id_type` is ``2`` in which case it will be ``bytes``.</span>
<span class="sd">        info : dict</span>
<span class="sd">            A dict containing information about the association request and</span>
<span class="sd">            the association requestor, with the keys:</span>

<span class="sd">            ::</span>

<span class="sd">              &#39;requestor&#39; : {</span>
<span class="sd">                  &#39;ae_title&#39; : bytes, the requestor&#39;s AE title</span>
<span class="sd">                  &#39;address&#39; : str, the requestor&#39;s IP address</span>
<span class="sd">                  &#39;port&#39; : int, the requestor&#39;s port number</span>
<span class="sd">              }</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        is_verified : bool</span>
<span class="sd">            Return True if the user identity has been confirmed and you wish</span>
<span class="sd">            to proceed with association establishment, False otherwise.</span>
<span class="sd">        response : bytes or None</span>
<span class="sd">            If ``user_id_type`` is:</span>

<span class="sd">            * 1 or 2, then return None</span>
<span class="sd">            * 3 then return the Kerberos Server ticket as bytes</span>
<span class="sd">            * 4 then return the SAML response as bytes</span>
<span class="sd">            * 5 then return the JSON web token as bytes</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        * DICOM Standard Part 7, `Annex D.3.3.7 &lt;http://dicom.nema.org/medical/dicom/current/output/chtml/part07/sect_D.3.3.7.html&gt;`_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;User Identity Negotiation not implemented&quot;</span><span class="p">)</span></div>


    <span class="c1"># High-level DIMSE-C callbacks - user should implement these as required</span>
<div class="viewcode-block" id="ApplicationEntity.on_c_echo"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity.on_c_echo">[docs]</a>    <span class="k">def</span> <span class="nf">on_c_echo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when a C-ECHO request is received.</span>

<span class="sd">        User implementation is not required for the C-ECHO service, but if you</span>
<span class="sd">        intend to do so it should be defined prior to calling</span>
<span class="sd">        ``ApplicationEntity.start()`` and</span>
<span class="sd">        must return either an ``int`` or a pydicom ``Dataset`` containing a</span>
<span class="sd">        (0000,0900) *Status* element with a valid C-ECHO status value.</span>

<span class="sd">        **Supported Service Classes**</span>

<span class="sd">        *Verification Service Class*</span>

<span class="sd">        **Status**</span>

<span class="sd">        Success</span>
<span class="sd">          | ``0x0000`` Success</span>

<span class="sd">        Failure</span>
<span class="sd">          | ``0x0122`` Refused: SOP Class Not Supported</span>
<span class="sd">          | ``0x0210`` Refused: Duplicate Invocation</span>
<span class="sd">          | ``0x0211`` Refused: Unrecognised Operation</span>
<span class="sd">          | ``0x0212`` Refused: Mistyped Argument</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        context : presentation.PresentationContextTuple</span>
<span class="sd">            The presentation context that the C-ECHO message was sent under</span>
<span class="sd">            as a ``namedtuple`` with field names ``context_id``,</span>
<span class="sd">            ``abstract_syntax`` and ``transfer_syntax``.</span>
<span class="sd">        info : dict</span>
<span class="sd">            A dict containing information about the current association, with</span>
<span class="sd">            the keys:</span>

<span class="sd">            ::</span>

<span class="sd">              &#39;requestor&#39; : {</span>
<span class="sd">                  &#39;ae_title&#39; : bytes, the requestor&#39;s calling AE title</span>
<span class="sd">                  &#39;called_aet&#39; : bytes, the requestor&#39;s called AE title</span>
<span class="sd">                  &#39;address&#39; : str, the requestor&#39;s IP address</span>
<span class="sd">                  &#39;port&#39; : int, the requestor&#39;s port number</span>
<span class="sd">              }</span>
<span class="sd">              &#39;acceptor&#39; : {</span>
<span class="sd">                  &#39;ae_title&#39; : bytes, the acceptor&#39;s AE title</span>
<span class="sd">                  &#39;address&#39; : str, the acceptor&#39;s IP address</span>
<span class="sd">                  &#39;port&#39; : int, the acceptor&#39;s port number</span>
<span class="sd">              }</span>
<span class="sd">              &#39;parameters&#39; : {</span>
<span class="sd">                  &#39;message_id&#39; : int, the DIMSE message ID</span>
<span class="sd">                  &#39;priority&#39; : int, the requested operation priority</span>
<span class="sd">                  &#39;originator_aet&#39; : bytes or None, the move originator&#39;s AE</span>
<span class="sd">                                     title</span>
<span class="sd">                  &#39;originator_message_id&#39; : int or None, the move originator&#39;s</span>
<span class="sd">                                            message ID</span>
<span class="sd">              }</span>
<span class="sd">              &#39;sop_class_extended&#39; : {</span>
<span class="sd">                  SOP Class UID : Service Class Application Information,</span>
<span class="sd">              }</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        status : pydicom.dataset.Dataset or int</span>
<span class="sd">            The status returned to the peer AE in the C-ECHO response. Must be</span>
<span class="sd">            a valid C-ECHO status value for the applicable Service Class as</span>
<span class="sd">            either an ``int`` or a ``Dataset`` object containing (at a minimum)</span>
<span class="sd">            a (0000,0900) *Status* element. If returning a ``Dataset`` object</span>
<span class="sd">            then it may also contain optional elements related to the Status</span>
<span class="sd">            (as in the DICOM Standard Part 7, Annex C).</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        association.Association.send_c_echo</span>
<span class="sd">        dimse_primitives.C_ECHO</span>
<span class="sd">        service_class.VerificationServiceClass</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        * DICOM Standard Part 4, `Annex A &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_A&gt;`_</span>
<span class="sd">        * DICOM Standard Part 7, Sections</span>
<span class="sd">          `9.1.5 &lt;http://dicom.nema.org/medical/dicom/current/output/html/part07.html#sect_9.1.5&gt;`_,</span>
<span class="sd">          `9.3.5 &lt;http://dicom.nema.org/medical/dicom/current/output/html/part07.html#sect_9.3.5&gt;`_</span>
<span class="sd">          and `Annex C &lt;http://dicom.nema.org/medical/dicom/current/output/html/part07.html#chapter_C&gt;`_</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># User implementation of on_c_echo is optional</span>
        <span class="k">return</span> <span class="mh">0x0000</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_c_find"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity.on_c_find">[docs]</a>    <span class="k">def</span> <span class="nf">on_c_find</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when a C-FIND request is received.</span>

<span class="sd">        Must be defined by the user prior to calling ``AE.start()`` and must</span>
<span class="sd">        yield ``(status, identifier)`` pairs, where *status* is either an</span>
<span class="sd">        ``int`` or pydicom ``Dataset`` containing a (0000,0900) *Status*</span>
<span class="sd">        element and *identifier* is a C-FIND *Identifier* ``Dataset``.</span>

<span class="sd">        **Supported Service Classes**</span>

<span class="sd">        * *Query/Retrieve Service Class*</span>
<span class="sd">        * *Basic Worklist Management Service*</span>
<span class="sd">        * *Relevant Patient Information Query Service*</span>
<span class="sd">        * *Substance Administration Query Service*</span>
<span class="sd">        * *Hanging Protocol Query/Retrieve Service*</span>
<span class="sd">        * *Defined Procedure Protocol Query/Retrieve Service*</span>
<span class="sd">        * *Color Palette Query/Retrieve Service*</span>
<span class="sd">        * *Implant Template Query/Retrieve Service*</span>

<span class="sd">        **Status**</span>

<span class="sd">        Success</span>
<span class="sd">          | ``0x0000`` Success</span>

<span class="sd">        Failure</span>
<span class="sd">          | ``0xA700`` Out of resources</span>
<span class="sd">          | ``0xA900`` Identifier does not match SOP class</span>
<span class="sd">          | ``0xC000`` to ``0xCFFF`` Unable to process</span>

<span class="sd">        Cancel</span>
<span class="sd">          | ``0xFE00`` Matching terminated due to Cancel request</span>

<span class="sd">        Pending</span>
<span class="sd">          | ``0xFF00`` Matches are continuing: current match is supplied and</span>
<span class="sd">             any Optional Keys were supported in the same manner as Required</span>
<span class="sd">             Keys</span>
<span class="sd">          | ``0xFF01`` Matches are continuing: warning that one or more Optional</span>
<span class="sd">            Keys were not supported for existence and/or matching for this</span>
<span class="sd">            Identifier</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dataset : pydicom.dataset.Dataset</span>
<span class="sd">            The DICOM Identifier dataset sent by the peer in the C-FIND</span>
<span class="sd">            request.</span>
<span class="sd">        context : presentation.PresentationContextTuple</span>
<span class="sd">            The presentation context that the C-FIND message was sent under</span>
<span class="sd">            as a ``namedtuple`` with field names ``context_id``,</span>
<span class="sd">            ``abstract_syntax`` and ``transfer_syntax``.</span>
<span class="sd">        info : dict</span>
<span class="sd">            A dict containing information about the current association, with</span>
<span class="sd">            the keys:</span>

<span class="sd">            ::</span>

<span class="sd">              &#39;requestor&#39; : {</span>
<span class="sd">                  &#39;ae_title&#39; : bytes, the requestor&#39;s calling AE title</span>
<span class="sd">                  &#39;called_aet&#39; : bytes, the requestor&#39;s called AE title</span>
<span class="sd">                  &#39;address&#39; : str, the requestor&#39;s IP address</span>
<span class="sd">                  &#39;port&#39; : int, the requestor&#39;s port number</span>
<span class="sd">              }</span>
<span class="sd">              &#39;acceptor&#39; : {</span>
<span class="sd">                  &#39;ae_title&#39; : bytes, the acceptor&#39;s AE title</span>
<span class="sd">                  &#39;address&#39; : str, the acceptor&#39;s IP address</span>
<span class="sd">                  &#39;port&#39; : int, the acceptor&#39;s port number</span>
<span class="sd">              }</span>
<span class="sd">              &#39;parameters&#39; : {</span>
<span class="sd">                  &#39;message_id&#39; : int, the DIMSE message ID</span>
<span class="sd">                  &#39;priority&#39; : int, the requested operation priority</span>
<span class="sd">              }</span>
<span class="sd">              &#39;sop_class_extended&#39; : {</span>
<span class="sd">                  SOP Class UID : Service Class Application Information,</span>
<span class="sd">              }</span>
<span class="sd">              &#39;cancelled&#39; : callable_function</span>

<span class="sd">            Where *callable_function* is a function that takes a `msg_id`</span>
<span class="sd">            parameter (as int ) and returns True if a C-CANCEL message has</span>
<span class="sd">            been received with a *Message ID Being Responded To* value that</span>
<span class="sd">            corresponds to `msg_id`, False otherwise. For example:</span>
<span class="sd">            ``is_cancelled = info[&#39;cancelled&#39;](msg_id)``</span>

<span class="sd">        Yields</span>
<span class="sd">        ------</span>
<span class="sd">        status : pydicom.dataset.Dataset or int</span>
<span class="sd">            The status returned to the peer AE in the C-FIND response. Must be</span>
<span class="sd">            a valid C-FIND status vuale for the applicable Service Class as</span>
<span class="sd">            either an ``int`` or a ``Dataset`` object containing (at a minimum)</span>
<span class="sd">            a (0000,0900) *Status* element. If returning a Dataset object then</span>
<span class="sd">            it may also contain optional elements related to the Status (as in</span>
<span class="sd">            DICOM Standard Part 7, Annex C).</span>
<span class="sd">        identifier : pydicom.dataset.Dataset or None</span>
<span class="sd">            If the status is &#39;Pending&#39; then the *Identifier* ``Dataset`` for a</span>
<span class="sd">            matching SOP Instance. The exact requirements for the C-FIND</span>
<span class="sd">            response *Identifier* are Service Class specific (see the</span>
<span class="sd">            DICOM Standard, Part 4).</span>

<span class="sd">            If the status is &#39;Failure&#39; or &#39;Cancel&#39; then yield ``None``.</span>

<span class="sd">            If the status is &#39;Success&#39; then yield ``None``, however yielding a</span>
<span class="sd">            final &#39;Success&#39; status is not required and will be ignored if</span>
<span class="sd">            necessary.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        association.Association.send_c_find</span>
<span class="sd">        dimse_primitives.C_FIND</span>
<span class="sd">        service_class.QueryRetrieveFindServiceClass</span>
<span class="sd">        service_class.BasicWorklistManagementServiceClass</span>
<span class="sd">        service_class.RelevantPatientInformationQueryServiceClass</span>
<span class="sd">        service_class.SubstanceAdministrationQueryServiceClass</span>
<span class="sd">        service_class.HangingProtocolQueryRetrieveServiceClass</span>
<span class="sd">        service_class.DefinedProcedureProtocolQueryRetrieveServiceClass</span>
<span class="sd">        service_class.ColorPaletteQueryRetrieveServiceClass</span>
<span class="sd">        service_class.ImplantTemplateQueryRetrieveServiceClass</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        * DICOM Standard Part 4, Annexes</span>
<span class="sd">          `C &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_C&gt;`_,</span>
<span class="sd">          `K &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_K&gt;`_,</span>
<span class="sd">          `Q &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_Q&gt;`_,</span>
<span class="sd">          `U &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_U&gt;`_,</span>
<span class="sd">          `V &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_V&gt;`_,</span>
<span class="sd">          `X &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_X&gt;`_,</span>
<span class="sd">          `BB &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_BB&gt;`_,</span>
<span class="sd">          `CC &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_CC&gt;`_</span>
<span class="sd">          and `HH &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_HH&gt;`_</span>
<span class="sd">        * DICOM Standard Part 7, Sections</span>
<span class="sd">          `9.1.2 &lt;http://dicom.nema.org/medical/dicom/current/output/html/part07.html#sect_9.1.2&gt;`_,</span>
<span class="sd">          `9.3.2 &lt;http://dicom.nema.org/medical/dicom/current/output/html/part07.html#sect_9.3.2&gt;`_</span>
<span class="sd">          and `Annex C &lt;http://dicom.nema.org/medical/dicom/current/output/html/part07.html#chapter_C&gt;`_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;User must implement the AE.on_c_find &quot;</span>
                                  <span class="s2">&quot;function prior to calling AE.start()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_c_get"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity.on_c_get">[docs]</a>    <span class="k">def</span> <span class="nf">on_c_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when a C-GET request is received.</span>

<span class="sd">        Must be defined by the user prior to calling</span>
<span class="sd">        ``ApplicationEntity.start()`` and must yield a ``int`` containing the</span>
<span class="sd">        total number of C-STORE sub-operations, then yield ``(status,</span>
<span class="sd">        dataset)`` pairs.</span>

<span class="sd">        **Supported Service Classes**</span>

<span class="sd">        * *Query/Retrieve Service Class*</span>
<span class="sd">        * *Hanging Protocol Query/Retrieve Service*</span>
<span class="sd">        * *Defined Procedure Protocol Query/Retrieve Service*</span>
<span class="sd">        * *Color Palette Query/Retrieve Service*</span>
<span class="sd">        * *Implant Template Query/Retrieve Service*</span>

<span class="sd">        **Status**</span>

<span class="sd">        Success</span>
<span class="sd">          | ``0x0000`` Sub-operations complete, no failures or warnings</span>

<span class="sd">        Failure</span>
<span class="sd">          | ``0xA701`` Out of resources: unable to calculate the number of</span>
<span class="sd">            matches</span>
<span class="sd">          | ``0xA702`` Out of resources: unable to perform sub-operations</span>
<span class="sd">          | ``0xA900`` Identifier does not match SOP class</span>
<span class="sd">          | ``0xAA00`` None of the frames requested were found in the SOP</span>
<span class="sd">            instance</span>
<span class="sd">          | ``0xAA01`` Unable to create new object for this SOP class</span>
<span class="sd">          | ``0xAA02`` Unable to extract frames</span>
<span class="sd">          | ``0xAA03`` Time-based request received for a non-time-based</span>
<span class="sd">            original SOP Instance</span>
<span class="sd">          | ``0xAA04`` Invalid request</span>
<span class="sd">          | ``0xC000`` to ``0xCFFF`` Unable to process</span>

<span class="sd">        Cancel</span>
<span class="sd">          | ``0xFE00`` Sub-operations terminated due to Cancel request</span>

<span class="sd">        Warning</span>
<span class="sd">          | ``0xB000`` Sub-operations complete, one or more failures or</span>
<span class="sd">            warnings</span>

<span class="sd">        Pending</span>
<span class="sd">          | ``0xFF00`` Matches are continuing - Current Match is supplied and</span>
<span class="sd">            any Optional Keys were supported in the same manner as Required</span>
<span class="sd">            Keys</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dataset : pydicom.dataset.Dataset</span>
<span class="sd">            The DICOM Identifier dataset sent by the peer in the C-GET request.</span>
<span class="sd">        context : presentation.PresentationContextTuple</span>
<span class="sd">            The presentation context that the C-GET message was sent under</span>
<span class="sd">            as a ``namedtuple`` with field names ``context_id``,</span>
<span class="sd">            ``abstract_syntax`` and ``transfer_syntax``.</span>
<span class="sd">        info : dict</span>
<span class="sd">            A dict containing information about the current association, with</span>
<span class="sd">            the keys:</span>

<span class="sd">            ::</span>

<span class="sd">              &#39;requestor&#39; : {</span>
<span class="sd">                  &#39;ae_title&#39; : bytes, the requestor&#39;s calling AE title</span>
<span class="sd">                  &#39;called_aet&#39; : bytes, the requestor&#39;s called AE title</span>
<span class="sd">                  &#39;address&#39; : str, the requestor&#39;s IP address</span>
<span class="sd">                  &#39;port&#39; : int, the requestor&#39;s port number</span>
<span class="sd">              }</span>
<span class="sd">              &#39;acceptor&#39; : {</span>
<span class="sd">                  &#39;ae_title&#39; : bytes, the acceptor&#39;s AE title</span>
<span class="sd">                  &#39;address&#39; : str, the acceptor&#39;s IP address</span>
<span class="sd">                  &#39;port&#39; : int, the acceptor&#39;s port number</span>
<span class="sd">              }</span>
<span class="sd">              &#39;parameters&#39; : {</span>
<span class="sd">                  &#39;message_id&#39; : int, the DIMSE message ID</span>
<span class="sd">                  &#39;priority&#39; : int, the requested operation priority</span>
<span class="sd">              }</span>
<span class="sd">              &#39;sop_class_extended&#39; : {</span>
<span class="sd">                  SOP Class UID : Service Class Application Information,</span>
<span class="sd">              }</span>
<span class="sd">              &#39;cancelled&#39; : callable_function</span>

<span class="sd">            Where *callable_function* is a function that takes a `msg_id`</span>
<span class="sd">            parameter (as int ) and returns True if a C-CANCEL message has</span>
<span class="sd">            been received with a *Message ID Being Responded To* value that</span>
<span class="sd">            corresponds to `msg_id`, False otherwise. For example:</span>
<span class="sd">            ``is_cancelled = info[&#39;cancelled&#39;](msg_id)``</span>

<span class="sd">        Yields</span>
<span class="sd">        ------</span>
<span class="sd">        int</span>
<span class="sd">            The first yielded value should be the total number of C-STORE</span>
<span class="sd">            sub-operations necessary to complete the C-GET operation. In other</span>
<span class="sd">            words, this is the number of matching SOP Instances to be sent to</span>
<span class="sd">            the peer.</span>
<span class="sd">        status : pydicom.dataset.Dataset or int</span>
<span class="sd">            The status returned to the peer AE in the C-GET response. Must be a</span>
<span class="sd">            valid C-GET status value for the applicable Service Class as either</span>
<span class="sd">            an ``int`` or a ``Dataset`` object containing (at a minimum) a</span>
<span class="sd">            (0000,0900) *Status* element. If returning a Dataset object then</span>
<span class="sd">            it may also contain optional elements related to the Status (as in</span>
<span class="sd">            DICOM Standard Part 7, Annex C).</span>
<span class="sd">        dataset : pydicom.dataset.Dataset or None</span>
<span class="sd">            If the status is &#39;Pending&#39; then yield the ``Dataset`` to send to</span>
<span class="sd">            the peer via a C-STORE sub-operation over the current association.</span>

<span class="sd">            If the status is &#39;Failed&#39;, &#39;Warning&#39; or &#39;Cancel&#39; then yield a</span>
<span class="sd">            ``Dataset`` with a (0008,0058) *Failed SOP Instance UID List*</span>
<span class="sd">            element containing a list of the C-STORE sub-operation SOP Instance</span>
<span class="sd">            UIDs for which the C-GET operation has failed.</span>

<span class="sd">            If the status is &#39;Success&#39; then yield ``None``, although yielding a</span>
<span class="sd">            final &#39;Success&#39; status is not required and will be ignored if</span>
<span class="sd">            necessary.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        association.Association.send_c_get</span>
<span class="sd">        dimse_primitives.C_GET</span>
<span class="sd">        service_class.QueryRetrieveGetServiceClass</span>
<span class="sd">        service_class.HangingProtocolQueryRetrieveServiceClass</span>
<span class="sd">        service_class.DefinedProcedureProtocolQueryRetrieveServiceClass</span>
<span class="sd">        service_class.ColorPaletteQueryRetrieveServiceClass</span>
<span class="sd">        service_class.ImplantTemplateQueryRetrieveServiceClass</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        * DICOM Standard Part 4, Annexes</span>
<span class="sd">          `C &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_C&gt;`_,</span>
<span class="sd">          `U &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_U&gt;`_,</span>
<span class="sd">          `X &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_X&gt;`_,</span>
<span class="sd">          `Y &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_Y&gt;`_,</span>
<span class="sd">          `Z &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_Z&gt;`_,</span>
<span class="sd">          `BB &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_BB&gt;`_</span>
<span class="sd">          and `HH &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_HH&gt;`_</span>
<span class="sd">        * DICOM Standard Part 7, Sections</span>
<span class="sd">          `9.1.3 &lt;http://dicom.nema.org/medical/dicom/current/output/html/part07.html#sect_9.1.3&gt;`_,</span>
<span class="sd">          `9.3.3 &lt;http://dicom.nema.org/medical/dicom/current/output/html/part07.html#sect_9.3.3&gt;`_</span>
<span class="sd">          and `Annex C &lt;http://dicom.nema.org/medical/dicom/current/output/html/part07.html#chapter_C&gt;`_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;User must implement the AE.on_c_get &quot;</span>
                                  <span class="s2">&quot;function prior to calling AE.start()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_c_move"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity.on_c_move">[docs]</a>    <span class="k">def</span> <span class="nf">on_c_move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">move_aet</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when a C-MOVE request is received.</span>

<span class="sd">        Must be defined by the user prior to calling</span>
<span class="sd">        ``ApplicationEntity.start()``.</span>

<span class="sd">        The first yield should be the ``(addr, port)`` of the move destination,</span>
<span class="sd">        the second yield the number of required C-STORE sub-operations as an</span>
<span class="sd">        ``int``, and the remaining yields the ``(status, dataset)`` pairs.</span>

<span class="sd">        Matching SOP Instances will be sent to the peer AE with AE title</span>
<span class="sd">        ``move_aet`` over a new association. If ``move_aet`` is unknown then</span>
<span class="sd">        the SCP will send a response with a &#39;Failure&#39; status of ``0xA801``</span>
<span class="sd">        &#39;Move Destination Unknown&#39;.</span>

<span class="sd">        **Supported Service Classes**</span>

<span class="sd">        * *Query/Retrieve Service*</span>
<span class="sd">        * *Hanging Protocol Query/Retrieve Service*</span>
<span class="sd">        * *Defined Procedure Protocol Query/Retrieve Service*</span>
<span class="sd">        * *Color Palette Query/Retrieve Service*</span>
<span class="sd">        * *Implant Template Query/Retrieve Service*</span>

<span class="sd">        **Status**</span>

<span class="sd">        Success</span>
<span class="sd">          | ``0x0000`` Sub-operations complete, no failures</span>

<span class="sd">        Pending</span>
<span class="sd">          | ``0xFF00`` Sub-operations are continuing</span>

<span class="sd">        Cancel</span>
<span class="sd">          | ``0xFE00`` Sub-operations terminated due to Cancel indication</span>

<span class="sd">        Failure</span>
<span class="sd">          | ``0x0122`` SOP class not supported</span>
<span class="sd">          | ``0x0124`` Not authorised</span>
<span class="sd">          | ``0x0210`` Duplicate invocation</span>
<span class="sd">          | ``0x0211`` Unrecognised operation</span>
<span class="sd">          | ``0x0212`` Mistyped argument</span>
<span class="sd">          | ``0xA701`` Out of resources: unable to calculate number of matches</span>
<span class="sd">          | ``0xA702`` Out of resources: unable to perform sub-operations</span>
<span class="sd">          | ``0xA801`` Move destination unknown</span>
<span class="sd">          | ``0xA900`` Identifier does not match SOP class</span>
<span class="sd">          | ``0xAA00`` None of the frames requested were found in the SOP</span>
<span class="sd">            instance</span>
<span class="sd">          | ``0xAA01`` Unable to create new object for this SOP class</span>
<span class="sd">          | ``0xAA02`` Unable to extract frames</span>
<span class="sd">          | ``0xAA03`` Time-based request received for a non-time-based</span>
<span class="sd">            original SOP Instance</span>
<span class="sd">          | ``0xAA04`` Invalid request</span>
<span class="sd">          | ``0xC000`` to ``0xCFFF`` Unable to process</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dataset : pydicom.dataset.Dataset</span>
<span class="sd">            The DICOM Identifier dataset sent by the peer in the C-MOVE request.</span>
<span class="sd">        move_aet : bytes</span>
<span class="sd">            The destination AE title that matching SOP Instances will be sent</span>
<span class="sd">            to using C-STORE sub-operations. ``move_aet`` will be a correctly</span>
<span class="sd">            formatted AE title (16 chars, with trailing spaces as padding).</span>
<span class="sd">        context : presentation.PresentationContextTuple</span>
<span class="sd">            The presentation context that the C-MOVE message was sent under</span>
<span class="sd">            as a ``namedtuple`` with field names ``context_id``,</span>
<span class="sd">            ``abstract_syntax`` and ``transfer_syntax``.</span>
<span class="sd">        info : dict</span>
<span class="sd">            A dict containing information about the current association, with</span>
<span class="sd">            the keys:</span>

<span class="sd">            ::</span>

<span class="sd">              &#39;requestor&#39; : {</span>
<span class="sd">                  &#39;ae_title&#39; : bytes, the requestor&#39;s calling AE title</span>
<span class="sd">                  &#39;called_aet&#39; : bytes, the requestor&#39;s called AE title</span>
<span class="sd">                  &#39;address&#39; : str, the requestor&#39;s IP address</span>
<span class="sd">                  &#39;port&#39; : int, the requestor&#39;s port number</span>
<span class="sd">              }</span>
<span class="sd">              &#39;acceptor&#39; : {</span>
<span class="sd">                  &#39;ae_title&#39; : bytes, the acceptor&#39;s AE title</span>
<span class="sd">                  &#39;address&#39; : str, the acceptor&#39;s IP address</span>
<span class="sd">                  &#39;port&#39; : int, the acceptor&#39;s port number</span>
<span class="sd">              }</span>
<span class="sd">              &#39;parameters&#39; : {</span>
<span class="sd">                  &#39;message_id&#39; : int, the DIMSE message ID</span>
<span class="sd">                  &#39;priority&#39; : int, the requested operation priority</span>
<span class="sd">              }</span>
<span class="sd">              &#39;sop_class_extended&#39; : {</span>
<span class="sd">                  SOP Class UID : Service Class Application Information,</span>
<span class="sd">              }</span>
<span class="sd">              &#39;cancelled&#39; : callable_function</span>

<span class="sd">            Where *callable_function* is a function that takes a `msg_id`</span>
<span class="sd">            parameter (as int) and returns True if a C-CANCEL message has</span>
<span class="sd">            been received with a *Message ID Being Responded To* value that</span>
<span class="sd">            corresponds to `msg_id`, False otherwise. For example:</span>
<span class="sd">            ``is_cancelled = info[&#39;cancelled&#39;](msg_id)``</span>

<span class="sd">        Yields</span>
<span class="sd">        ------</span>
<span class="sd">        addr, port : str, int or None, None</span>
<span class="sd">            The first yield should be the TCP/IP address and port number of the</span>
<span class="sd">            destination AE (if known) or ``(None, None)`` if unknown. If</span>
<span class="sd">            ``(None, None)`` is yielded then the SCP will send a C-MOVE</span>
<span class="sd">            response with a &#39;Failure&#39; Status of ``0xA801`` (move destination</span>
<span class="sd">            unknown), in which case nothing more needs to be yielded.</span>
<span class="sd">        int</span>
<span class="sd">            The second yield should be the number of C-STORE sub-operations</span>
<span class="sd">            required to complete the C-MOVE operation. In other words, this is</span>
<span class="sd">            the number of matching SOP Instances to be sent to the peer.</span>
<span class="sd">        status : pydiom.dataset.Dataset or int</span>
<span class="sd">            The status returned to the peer AE in the C-MOVE response. Must be</span>
<span class="sd">            a valid C-MOVE status value for the applicable Service Class as</span>
<span class="sd">            either an ``int`` or a ``Dataset`` containing (at a minimum) a</span>
<span class="sd">            (0000,0900) *Status* element. If returning a ``Dataset`` then it</span>
<span class="sd">            may also contain optional elements related to the Status (as in</span>
<span class="sd">            DICOM Standard Part 7, Annex C).</span>
<span class="sd">        dataset : pydicom.dataset.Dataset or None</span>
<span class="sd">            If the status is &#39;Pending&#39; then yield the ``Dataset``</span>
<span class="sd">            to send to the peer via a C-STORE sub-operation over a new</span>
<span class="sd">            association.</span>

<span class="sd">            If the status is &#39;Failed&#39;, &#39;Warning&#39; or &#39;Cancel&#39; then yield a</span>
<span class="sd">            ``Dataset`` with a (0008,0058) *Failed SOP Instance UID List*</span>
<span class="sd">            element containing the list of the C-STORE sub-operation SOP</span>
<span class="sd">            Instance UIDs for which the C-MOVE operation has failed.</span>

<span class="sd">            If the status is &#39;Success&#39; then yield ``None``, although yielding a</span>
<span class="sd">            final &#39;Success&#39; status is not required and will be ignored if</span>
<span class="sd">            necessary.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        association.Association.send_c_move</span>
<span class="sd">        dimse_primitives.C_MOVE</span>
<span class="sd">        service_class.QueryRetrieveMoveServiceClass</span>
<span class="sd">        service_class.HangingProtocolQueryRetrieveServiceClass</span>
<span class="sd">        service_class.DefinedProcedureProtocolQueryRetrieveServiceClass</span>
<span class="sd">        service_class.ColorPaletteQueryRetrieveServiceClass</span>
<span class="sd">        service_class.ImplantTemplateQueryRetrieveServiceClass</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        * DICOM Standard Part 4, Annexes</span>
<span class="sd">          `C &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_C&gt;`_,</span>
<span class="sd">          `U &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_U&gt;`_,</span>
<span class="sd">          `X &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_X&gt;`_,</span>
<span class="sd">          `Y &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_Y&gt;`_,</span>
<span class="sd">          `BB &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_BB&gt;`_</span>
<span class="sd">          and `HH &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_HH&gt;`_</span>
<span class="sd">        * DICOM Standard Part 7, Sections</span>
<span class="sd">          `9.1.4 &lt;http://dicom.nema.org/medical/dicom/current/output/html/part07.html#sect_9.1.4&gt;`_,</span>
<span class="sd">          `9.3.4 &lt;http://dicom.nema.org/medical/dicom/current/output/html/part07.html#sect_9.3.4&gt;`_</span>
<span class="sd">          and `Annex C &lt;http://dicom.nema.org/medical/dicom/current/output/html/part07.html#chapter_C&gt;`_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;User must implement the AE.on_c_move &quot;</span>
                                  <span class="s2">&quot;function prior to calling AE.start()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_c_store"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity.on_c_store">[docs]</a>    <span class="k">def</span> <span class="nf">on_c_store</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when a C-STORE request is received.</span>

<span class="sd">        Must be defined by the user prior to calling</span>
<span class="sd">        ``ApplicationEntity.start()`` and must return</span>
<span class="sd">        either an ``int`` or a pydicom ``Dataset`` containing a (0000,0900)</span>
<span class="sd">        *Status* element with a valid C-STORE status value.</span>

<span class="sd">        If the user is storing `dataset` in the DICOM File Format (as in the</span>
<span class="sd">        DICOM Standard Part 10, Section 7) then they are responsible for adding</span>
<span class="sd">        the DICOM File Meta Information.</span>

<span class="sd">        **Supported Service Classes**</span>

<span class="sd">        * *Storage Service Class*</span>
<span class="sd">        * *Non-Patient Object Storage Service Class*</span>

<span class="sd">        **Status**</span>

<span class="sd">        Success</span>
<span class="sd">          | ``0x0000`` - Success</span>

<span class="sd">        Warning</span>
<span class="sd">          | ``0xB000`` Coercion of data elements</span>
<span class="sd">          | ``0xB006`` Elements discarded</span>
<span class="sd">          | ``0xB007`` Dataset does not match SOP class</span>

<span class="sd">        Failure</span>
<span class="sd">          | ``0x0117`` Invalid SOP instance</span>
<span class="sd">          | ``0x0122`` SOP class not supported</span>
<span class="sd">          | ``0x0124`` Not authorised</span>
<span class="sd">          | ``0x0210`` Duplicate invocation</span>
<span class="sd">          | ``0x0211`` Unrecognised operation</span>
<span class="sd">          | ``0x0212`` Mistyped argument</span>
<span class="sd">          | ``0xA700`` to ``0xA7FF`` Out of resources</span>
<span class="sd">          | ``0xA900`` to ``0xA9FF`` Dataset does not match SOP class</span>
<span class="sd">          | ``0xC000`` to ``0xCFFF`` Cannot understand</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dataset : pydicom.dataset.Dataset or bytes</span>
<span class="sd">            The DICOM dataset sent by the peer in the C-STORE request as a</span>
<span class="sd">            pydicom Dataset object (default). If _config.DECODE_STORE_DATASETS</span>
<span class="sd">            is set to False then returns the raw encoded dataset sent by the</span>
<span class="sd">            service requestor as bytes.</span>
<span class="sd">        context : presentation.PresentationContextTuple</span>
<span class="sd">            The presentation context that the C-STORE message was sent under</span>
<span class="sd">            as a ``namedtuple`` with field names ``context_id``,</span>
<span class="sd">            ``abstract_syntax`` and ``transfer_syntax``.</span>
<span class="sd">        info : dict</span>
<span class="sd">            A dict containing information about the current association, with</span>
<span class="sd">            the keys:</span>

<span class="sd">            ::</span>

<span class="sd">              &#39;requestor&#39; : {</span>
<span class="sd">                  &#39;ae_title&#39; : bytes, the requestor&#39;s calling AE title</span>
<span class="sd">                  &#39;called_aet&#39; : bytes, the requestor&#39;s called AE title</span>
<span class="sd">                  &#39;address&#39; : str, the requestor&#39;s IP address</span>
<span class="sd">                  &#39;port&#39; : int, the requestor&#39;s port number</span>
<span class="sd">              }</span>
<span class="sd">              &#39;acceptor&#39; : {</span>
<span class="sd">                  &#39;ae_title&#39; : bytes, the acceptor&#39;s AE title</span>
<span class="sd">                  &#39;address&#39; : str, the acceptor&#39;s IP address</span>
<span class="sd">                  &#39;port&#39; : int, the acceptor&#39;s port number</span>
<span class="sd">              }</span>
<span class="sd">              &#39;parameters&#39; : {</span>
<span class="sd">                  &#39;message_id&#39; : int, the DIMSE message ID</span>
<span class="sd">                  &#39;priority&#39; : int, the requested operation priority</span>
<span class="sd">                  &#39;originator_aet&#39; : bytes or None, the move originator&#39;s AE</span>
<span class="sd">                                     title</span>
<span class="sd">                  &#39;originator_message_id&#39; : int or None, the move originator&#39;s</span>
<span class="sd">                                            message ID</span>
<span class="sd">              }</span>
<span class="sd">              &#39;sop_class_extended&#39; : {</span>
<span class="sd">                  SOP Class UID : Service Class Application Information,</span>
<span class="sd">              }</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        status : pydicom.dataset.Dataset or int</span>
<span class="sd">            The status returned to the peer AE in the C-STORE response. Must be</span>
<span class="sd">            a valid C-STORE status value for the applicable Service Class as</span>
<span class="sd">            either an ``int`` or a ``Dataset`` object containing (at a</span>
<span class="sd">            minimum) a (0000,0900) *Status* element. If returning a Dataset</span>
<span class="sd">            object then it may also contain optional elements related to the</span>
<span class="sd">            Status (as in the DICOM Standard Part 7, Annex C).</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        NotImplementedError</span>
<span class="sd">            If the callback has not been implemented by the user</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        association.Association.send_c_store</span>
<span class="sd">        dimse_primitives.C_STORE</span>
<span class="sd">        service_class.StorageServiceClass</span>
<span class="sd">        service_class.NonPatientObjectStorageServiceClass</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        * DICOM Standard Part 4, Annexes</span>
<span class="sd">          `B &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_B&gt;`_,</span>
<span class="sd">          `AA &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_AA&gt;`_,</span>
<span class="sd">          `FF &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_FF&gt;`_</span>
<span class="sd">          and `GG &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_GG&gt;`_</span>
<span class="sd">        * DICOM Standard Part 7, Sections</span>
<span class="sd">          `9.1.1 &lt;http://dicom.nema.org/medical/dicom/current/output/html/part07.html#sect_9.1.1&gt;`_,</span>
<span class="sd">          `9.3.1 &lt;http://dicom.nema.org/medical/dicom/current/output/html/part07.html#sect_9.3.1&gt;`_</span>
<span class="sd">          and `Annex C &lt;http://dicom.nema.org/medical/dicom/current/output/html/part07.html#chapter_C&gt;`_</span>
<span class="sd">        * DICOM Standard Part 10,</span>
<span class="sd">          `Section 7 &lt;http://dicom.nema.org/medical/dicom/current/output/html/part10.html#chapter_7&gt;`_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;User must implement the AE.on_c_store &quot;</span>
                                  <span class="s2">&quot;function prior to calling AE.start()&quot;</span><span class="p">)</span></div>


    <span class="c1"># High-level DIMSE-N callbacks - user should implement these as required</span>
<div class="viewcode-block" id="ApplicationEntity.on_n_action"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity.on_n_action">[docs]</a>    <span class="k">def</span> <span class="nf">on_n_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when a N-ACTION is received.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        DICOM Standard Part 4, Annexes H, J, P, S, CC and DD</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;User must implement the &quot;</span>
                                  <span class="s2">&quot;AE.on_n_action function prior to calling &quot;</span>
                                  <span class="s2">&quot;AE.start()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_n_create"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity.on_n_create">[docs]</a>    <span class="k">def</span> <span class="nf">on_n_create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when a N-CREATE is received.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        DICOM Standard Part 4, Annexes F, H, R, S, CC and DD</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;User must implement the &quot;</span>
                                  <span class="s2">&quot;AE.on_n_create function prior to calling &quot;</span>
                                  <span class="s2">&quot;AE.start()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_n_delete"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity.on_n_delete">[docs]</a>    <span class="k">def</span> <span class="nf">on_n_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when a N-DELETE is received.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        DICOM Standard Part 4, Annexes H and DD</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;User must implement the &quot;</span>
                                  <span class="s2">&quot;AE.on_n_delete function prior to calling &quot;</span>
                                  <span class="s2">&quot;AE.start()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_n_event_report"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity.on_n_event_report">[docs]</a>    <span class="k">def</span> <span class="nf">on_n_event_report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when a N-EVENT-REPORT is received.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        DICOM Standard Part 4, Annexes F, H, J, CC and DD</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;User must implement the &quot;</span>
                                  <span class="s2">&quot;AE.on_n_event_report function prior to &quot;</span>
                                  <span class="s2">&quot;calling AE.start()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_n_get"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity.on_n_get">[docs]</a>    <span class="k">def</span> <span class="nf">on_n_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when an N-GET request is received.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        attr : list of pydicom.tag.Tag</span>
<span class="sd">            The value of the (0000,1005) *Attribute Idenfier List* element</span>
<span class="sd">            containing the attribute tags for the N-GET operation.</span>
<span class="sd">        context : presentation.PresentationContextTuple</span>
<span class="sd">            The presentation context that the N-GET message was sent under</span>
<span class="sd">            as a ``namedtuple`` with field names ``context_id``,</span>
<span class="sd">            ``abstract_syntax`` and ``transfer_syntax``.</span>
<span class="sd">        info : dict</span>
<span class="sd">            A dict containing information about the current association, with</span>
<span class="sd">            the keys:</span>

<span class="sd">            ::</span>

<span class="sd">              &#39;requestor&#39; : {</span>
<span class="sd">                  &#39;ae_title&#39; : bytes, the requestor&#39;s calling AE title</span>
<span class="sd">                  &#39;called_aet&#39; : bytes, the requestor&#39;s called AE title</span>
<span class="sd">                  &#39;address&#39; : str, the requestor&#39;s IP address</span>
<span class="sd">                  &#39;port&#39; : int, the requestor&#39;s port number</span>
<span class="sd">              }</span>
<span class="sd">              &#39;acceptor&#39; : {</span>
<span class="sd">                  &#39;ae_title&#39; : bytes, the acceptor&#39;s AE title</span>
<span class="sd">                  &#39;address&#39; : str, the acceptor&#39;s IP address</span>
<span class="sd">                  &#39;port&#39; : int, the acceptor&#39;s port number</span>
<span class="sd">              }</span>
<span class="sd">              &#39;parameters&#39; : {</span>
<span class="sd">                  &#39;message_id&#39; : int, the DIMSE message ID</span>
<span class="sd">                  &#39;requested_sop_class&#39; : str, the N-GET-RQ&#39;s requested SOP</span>
<span class="sd">                  Class UID value</span>
<span class="sd">                  &#39;requested_sop_instance&#39; : str, the N-GET-RQ&#39;s requested SOP</span>
<span class="sd">                  Instance UID value</span>
<span class="sd">              }</span>
<span class="sd">              &#39;sop_class_extended&#39; : {</span>
<span class="sd">                  SOP Class UID : Service Class Application Information,</span>
<span class="sd">              }</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        status : pydicom.dataset.Dataset or int</span>
<span class="sd">            The status returned to the peer AE in the N-GET response. Must be a</span>
<span class="sd">            valid N-GET status value for the applicable Service Class as either</span>
<span class="sd">            an ``int`` or a ``Dataset`` object containing (at a minimum) a</span>
<span class="sd">            (0000,0900) *Status* element. If returning a Dataset object then</span>
<span class="sd">            it may also contain optional elements related to the Status (as in</span>
<span class="sd">            DICOM Standard Part 7, Annex C).</span>
<span class="sd">        dataset : pydicom.dataset.Dataset or None</span>
<span class="sd">            If the status category is &#39;Success&#39; or &#39;Warning&#39; then a dataset</span>
<span class="sd">            containing elements matching the request&#39;s Attribute List</span>
<span class="sd">            conformant to the specifications in the corresponding Service</span>
<span class="sd">            Class.</span>

<span class="sd">            If the status is not &#39;Successs&#39; or &#39;Warning&#39; then return None.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        association.Association.send_n_get</span>
<span class="sd">        dimse_primitives.N_GET</span>
<span class="sd">        service_class.DisplaySystemManagementServiceClass</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        * DICOM Standart Part 4, `Annex F &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_F&gt;`_</span>
<span class="sd">        * DICOM Standart Part 4, `Annex H &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_H&gt;`_</span>
<span class="sd">        * DICOM Standard Part 4, `Annex S &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_S&gt;`_</span>
<span class="sd">        * DICOM Standard Part 4, `Annex CC &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_CC&gt;`_</span>
<span class="sd">        * DICOM Standard Part 4, `Annex DD &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_DD&gt;`_</span>
<span class="sd">        * DICOM Standard Part 4, `Annex EE &lt;http://dicom.nema.org/medical/dicom/current/output/html/part04.html#chapter_EE&gt;`_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">&quot;User must implement the AE.on_n_get function prior to calling &quot;</span>
            <span class="s2">&quot;AE.start()&quot;</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_n_set"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity.on_n_set">[docs]</a>    <span class="k">def</span> <span class="nf">on_n_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when a N-SET is received.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        DICOM Standard Part 4, Annexes F, H, CC and DD</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;User must implement the &quot;</span>
                                  <span class="s2">&quot;AE.on_n_set function prior to calling &quot;</span>
                                  <span class="s2">&quot;AE.start()&quot;</span><span class="p">)</span></div>


    <span class="c1"># Communication related callbacks</span>
<div class="viewcode-block" id="ApplicationEntity.on_receive_connection"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity.on_receive_connection">[docs]</a>    <span class="k">def</span> <span class="nf">on_receive_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for a connection is received.</span>
<span class="sd">        ** NOT IMPLEMENTED **</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_make_connection"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity.on_make_connection">[docs]</a>    <span class="k">def</span> <span class="nf">on_make_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for a connection is made.</span>
<span class="sd">        ** NOT IMPLEMENTED **</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>


    <span class="c1"># High-level Association related callbacks</span>
<div class="viewcode-block" id="ApplicationEntity.on_association_requested"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity.on_association_requested">[docs]</a>    <span class="k">def</span> <span class="nf">on_association_requested</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">primitive</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for an association is requested.</span>
<span class="sd">        ** NOT IMPLEMENTED **</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_association_accepted"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity.on_association_accepted">[docs]</a>    <span class="k">def</span> <span class="nf">on_association_accepted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">primitive</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when an association is accepted.</span>
<span class="sd">        ** NOT IMPLEMENTED **</span>
<span class="sd">        Placeholder for a function callback. Function will be called</span>
<span class="sd">        when an association attempt is accepted by either the local or peer AE</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pdu_primitives.A_ASSOCIATE</span>
<span class="sd">            The A-ASSOCIATE (accept) primitive.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_association_rejected"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity.on_association_rejected">[docs]</a>    <span class="k">def</span> <span class="nf">on_association_rejected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">primitive</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when an association is rejected.</span>
<span class="sd">        ** NOT IMPLEMENTED **</span>
<span class="sd">        Placeholder for a function callback. Function will be called</span>
<span class="sd">        when an association attempt is rejected by a peer AE</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        associate_rq_pdu : pynetdicom.pdu.A_ASSOCIATE_RJ</span>
<span class="sd">            The A-ASSOCIATE-RJ PDU instance received from the peer AE</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_association_released"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity.on_association_released">[docs]</a>    <span class="k">def</span> <span class="nf">on_association_released</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">primitive</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when an association is released.</span>
<span class="sd">        ** NOT IMPLEMENTED **</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_association_aborted"><a class="viewcode-back" href="../../reference/generated/pynetdicom.ae.ApplicationEntity.html#pynetdicom.ae.ApplicationEntity.on_association_aborted">[docs]</a>    <span class="k">def</span> <span class="nf">on_association_aborted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">primitive</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when an association is aborted.</span>
<span class="sd">        ** NOT IMPLEMENTED **</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># FIXME: Need to standardise callback parameters for A-ABORT</span>
        <span class="k">pass</span></div></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018-19, pynetdicom contributors

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>